(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{752:function(e,t,n){"use strict";var a=Array.isArray,o=Object.keys,i=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var s,r,l,c=a(t),p=a(n);if(c&&p){if((r=t.length)!=n.length)return!1;for(s=r;0!=s--;)if(!e(t[s],n[s]))return!1;return!0}if(c!=p)return!1;var d=t instanceof Date,h=n instanceof Date;if(d!=h)return!1;if(d&&h)return t.getTime()==n.getTime();var f=t instanceof RegExp,m=n instanceof RegExp;if(f!=m)return!1;if(f&&m)return t.toString()==n.toString();var u=o(t);if((r=u.length)!==o(n).length)return!1;for(s=r;0!=s--;)if(!i.call(n,u[s]))return!1;for(s=r;0!=s--;)if(!e(t[l=u[s]],n[l]))return!1;return!0}return t!=t&&n!=n}},863:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(633),s=n(701),r=n(629),l=n(632),c=n(730),p=n(752),d=n.n(p),h=n(765),f=n.n(h),m=n(33),u=n.n(m),g=n(1),b=n.n(g),C=n(15),y=n.n(C),x=n(795),w=n(7),E=n(803);class S extends a.Component{constructor(e){super(e);let t=this.props.form;!t&&this.props.fields&&(t=this.createForm(this.props.fields)),this.state={open:this.props.open,searchCondition:{...this.props.defaultCondition},searchForm:t}}componentDidMount(){this.props.fields&&(this.validationConstraints=Object(E.a)(this.props.fields,this.context))}open(){this.setState({open:!0})}close(){this.setState({open:!1})}shouldComponentUpdate(e,t){return!d()(t.open,this.state.open)||(!d()(e.defaultCondition,this.props.defaultCondition)||(!d()(e.searchLabel,this.props.searchLabel)||!d()(e.cancelLabel,this.props.cancelLabel)||(!d()(t.searchCondition,this.state.searchCondition)||!(!e.fields||this.props.fields)&&(console.log("fields changed, rerender search form"),!0))))}componentDidUpdate(e){if(this.props.fields&&!this.props.form&&!d()(e.fields,this.props.fields)){const e=this.createForm(this.props.fields);this.setState({searchForm:e}),this.validationConstraints=Object(E.a)(this.props.fields,this.context)}d()(e.defaultCondition,this.props.defaultCondition)||this.setState({searchCondition:{...this.props.defaultCondition}})}createForm(e){return(t,n)=>{let a=this.fields=y.a.cloneDeep(e);return this.props.isReport||Array.from(a).forEach(e=>{if(delete e.tab,delete e.handle_value_changed,a.length<=3&&a.length>0?e.grid_configs_required={md:12/a.length,lg:12/a.length,readOnly:!1}:e.grid_configs_required={md:4,lg:4,readOnly:!1},"Date"===e.type){let t=Object.assign({},e);t.name=t.name+"_tu",t.header=t.header+" từ",t.setCondition=(t,n)=>{let a=u()(n).startOf("date").toDate();t[e.name]&&"object"==typeof t[e.name]?t[e.name].$gte=a:t[e.name]={$gte:a}},a.push(t);let n=Object.assign({},e);n.name=n.name+"_den",n.header=n.header+" đến",n.setCondition=(t,n)=>{let a=u()(n).startOf("date").toDate();t[e.name]&&"object"==typeof t[e.name]?t[e.name].$lte=a:t[e.name]={$lte:a}},a.push(n),a=a.filter(t=>t.name!==e.name)}"Number"===e.type&&(e.setCondition=(t,n)=>{t[e.name]=n})}),o.a.createElement(x.default,{style:{padding:0},fields:a,data:t,handleValueChanged:n})}}search(){let e=this.state.searchCondition,t=this.validationConstraints||{},n=f()(e,t,{format:"flat"});if(n){let e=n.join("<br/>");this.context.alert(e)}else this.setState({open:!1},()=>{this.props.onSearch&&this.props.onSearch(e,this.state.query,this.fields)})}handleSearchConditionChanged(e,t){let n=y.a.cloneDeep(this.state.searchCondition);for(let t in e)n[t]=e[t];let a=this.state.query;if(t)if(a)for(let e in t)"$or"!=e&&"$and"!=e||!a[e]?a[e]=t[e]:a=[e].push(t[e]);else a={...t};this.setState({searchCondition:n,query:a})}render(){if(!this.state.open)return null;const{searchCondition:e,searchForm:t}=this.state;return o.a.createElement(r.a,{maxWidth:this.props.formSize||"md",open:!1!==this.props.allowClose&&this.state.open,onClose:()=>this.setState({open:!1}),disableBackdropClick:this.props.disableBackdropClick,disableEscapeKeyDown:this.props.disableEscapeKeyDown},o.a.createElement(c.a,{style:{backgroundColor:this.context.config.formHeaderColor,color:this.context.config.mainTextColor}},o.a.createElement(s.a,{container:!0,direction:"row",justify:"space-between"},o.a.createElement(s.a,{item:!0},this.context.apis.getLabel("Điều kiện lọc")),o.a.createElement(s.a,{item:!0,style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingLeft:10}},o.a.createElement(i.a,{type:"Button",variant:"contained",color:"secondary",onClick:this.search.bind(this)},this.context.apis.getLabel(this.props.searchLabel||"Tìm")),!1!==this.props.allowClose&&o.a.createElement(i.a,{variant:"contained",style:{marginLeft:5},onClick:()=>this.setState({open:!1})},this.context.apis.getLabel(this.props.cancelLabel||"Tắt"))))),o.a.createElement(l.a,{style:{padding:0}},o.a.createElement("form",{noValidate:!0,style:{display:"flex",flexDirection:"column"}},o.a.createElement("div",{style:{flexGrow:1}},!!t&&t(e,this.handleSearchConditionChanged.bind(this))))))}}S.contextType=w.a,S.propTypes={fields:b.a.arrayOf(b.a.object),onSearch:b.a.func,form:b.a.func,defaultCondition:b.a.object,open:b.a.bool,isReport:b.a.bool,disableBackdropClick:b.a.bool,disableEscapeKeyDown:b.a.bool,searchLabel:b.a.string,cancelLabel:b.a.string,allowClose:b.a.bool,formSize:b.a.oneOf(["sm","md","lg"])},t.default=S}}]);