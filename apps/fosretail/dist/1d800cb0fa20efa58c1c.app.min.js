(window.webpackJsonp=window.webpackJsonp||[]).push([[21,31],{1357:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(1),s=a.n(i),r=a(633),c=a(701),o=a(706),m=a(708),h=a(707),d=a(709),u=a(106),g=a(629),p=a(632),E=a(730),x=a(7),y=a(26),f=a(228),b=a.n(f),_=a(179),v=a(33),L=a.n(v);class k extends l.a.Component{constructor(e){super(e),this.state={dialogOpen:!1,data:null,load:0},this.showForm=this.showForm.bind(this),this.cancel=this.cancel.bind(this)}async componentDidMount(){}showForm(e){this.timeout&&clearTimeout(this.timeout),this.setState({data:null,rows:[]},()=>{e&&e._id&&this.loadMember(e._id).then(()=>{this.timeout=setTimeout(()=>{this.cancel()},6e4)})})}handleClose(){this.timeout&&clearTimeout(this.timeout),this.setState({dialogOpen:!1})}cancel(){this.timeout&&clearTimeout(this.timeout),this.setState({dialogOpen:!1})}async loadMember(e){this.context.setProgressStatus(!0);try{let t=await this.context.apis.asyncGetData(this.context.userInfo.token,"checkin",{_id:e});if("1"===t.trang_thai&&!t.ma_nv)return this.context.alert(this.context.apis.getLabel("Không tìm thấy thông tin nhân viên"));if("2"===t.trang_thai&&!t.ma_kh)return this.context.alert(this.context.apis.getLabel("Không tìm thấy thông tin khách hàng"));let a={type:t.type,device_user_id:t.device_user_id};a.record_time={$gte:L()(t.record_time).startOf("date").toDate(),$lte:L()(t.record_time).endOf("date").toDate()};let n=await this.context.apis.asyncGetList(this.context.userInfo.token,"checkin",{condition:a,sort:{record_time:1}});this.setState({data:t,rows:n,load:this.state.load+1,dialogOpen:!0}),this.context.setProgressStatus(!1)}catch(e){this.context.alert(e.message)}}renderMember(e,t=[]){if(!e)return null;let a=e.picture?`${this.context.config.server_url}${e.picture}?size=M&access_token=${(this.context.userInfo||{}).token}`:"/images/logo.png";return l.a.createElement(l.a.Fragment,null,l.a.createElement(c.a,{container:!0,spacing:2},l.a.createElement(c.a,{item:!0,xs:12,sm:12,md:4,lg:4,style:{display:"flex",alignItems:"center",justifyContent:"center"}},l.a.createElement(_.LazyLoadImage,{src:a,style:{maxHeight:180}})),l.a.createElement(c.a,{item:!0,xs:12,sm:12,md:8,lg:8},l.a.createElement("div",{style:{display:"flex",alignItems:"center"}},l.a.createElement(u.a,null,this.context.apis.getLabel("Mã vân tay"),": "),l.a.createElement(u.a,{style:{fontWeight:"bold",marginLeft:10}},e.device_user_id)),l.a.createElement("div",{style:{display:"flex",alignItems:"center"}},l.a.createElement(u.a,null,this.context.apis.getLabel("Mã"),": "),l.a.createElement(u.a,{style:{fontWeight:"bold",marginLeft:5}},e.ma_kh||e.ma_nv),l.a.createElement(u.a,{style:{marginLeft:20}},this.context.apis.getLabel("Tên"),": "),l.a.createElement(u.a,{style:{fontWeight:"bold",marginLeft:5}},e.ten_kh||e.ten_nv)))),l.a.createElement(o.a,{style:{marginTop:20}},l.a.createElement(h.a,null,l.a.createElement(d.a,null,l.a.createElement(u.a,null,this.context.apis.getLabel("STT"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,this.context.apis.getLabel("Ngày check-in"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,this.context.apis.getLabel("Giờ vào"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,this.context.apis.getLabel("Giờ ra"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,this.context.apis.getLabel("Trạng thái")))),t.map((t,a)=>l.a.createElement(m.a,{key:a.toString()},l.a.createElement(d.a,null,l.a.createElement(u.a,null,a+1)),l.a.createElement(d.a,null,l.a.createElement(u.a,null,L()(t.record_time).format("DD/MM/YYYY"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,a%2==0&&L()(e.record_time).format("HH:mm A"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,a%2!=0&&L()(e.record_time).format("HH:mm A"))),l.a.createElement(d.a,null,l.a.createElement(u.a,null,a%2==0?this.context.apis.getLabel("Check-in"):this.context.apis.getLabel("Check-out")))))))}dialog(){const{formHeaderColor:e,mainTextColor:t}=this.context.config,{getLabel:a}=this.context.apis;return l.a.createElement(g.a,{fullScreen:!0,fullWidth:!0,maxWidth:"lg",open:this.state.dialogOpen,onClose:()=>this.cancel()},l.a.createElement(E.a,{style:{backgroundColor:e,color:t}},l.a.createElement(c.a,{container:!0,direction:"row",justify:"space-between"},l.a.createElement(c.a,{item:!0},a("Check in")),l.a.createElement(c.a,{item:!0},l.a.createElement(r.a,{onClick:()=>this.cancel(),style:{color:t}},l.a.createElement(b.a,{style:{color:"silver"}}))))),l.a.createElement(p.a,null,l.a.createElement("div",{style:{padding:20}},this.state.data&&this.renderMember(this.state.data,this.state.rows))))}render(){return this.dialog()}}k.contextType=x.a,k.propTypes={mediaQueryMatches:s.a.bool},t.default=Object(y.a)("(max-width:480px)")(k)},730:function(e,t,a){"use strict";var n=a(2),l=a(3),i=a(0),s=(a(1),a(4)),r=a(6),c=a(106),o=i.forwardRef((function(e,t){var a=e.children,r=e.classes,o=e.className,m=e.disableTypography,h=void 0!==m&&m,d=Object(l.a)(e,["children","classes","className","disableTypography"]);return i.createElement("div",Object(n.a)({className:Object(s.a)(r.root,o),ref:t},d),h?a:i.createElement(c.a,{component:"h2",variant:"h6"},a))}));t.a=Object(r.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(o)}}]);