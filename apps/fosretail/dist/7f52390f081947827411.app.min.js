(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{1374:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(338),i=n(633),c=n(228),s=n.n(c),u=n(106),l=n(629),h=n(632),f=n(730),p=n(715),y=n(7),d=n(10),m=n(33),g=n.n(m);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,a)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E(t);if(e){var a=E(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return w(this,n)}}function w(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?C(t):e}function C(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(b,t);var e,n,r,c,y,m=_(b);function b(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(e=m.call(this,t)).handleValueChanged=e.handleValueChanged.bind(C(e)),e.state={open:!1,evoucher_code:""},e}return e=b,(n=[{key:"open",value:function(t,e,n){this.callback=n,this.ma_kh=e,this.setState({title:t,evoucher_code:"",open:!0})}},{key:"close",value:function(){this.setState({open:!1})}},{key:"add",value:(c=regeneratorRuntime.mark((function t(){var e,n,r,a,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.evoucher_code){t.next=2;break}return t.abrupt("return",this.context.alert(this.context.apis.getLabel("Bạn chưa nhập mã thẻ giảm giá")));case 2:return e={ma:this.state.evoucher_code.toUpperCase()},this.context.setProgressStatus(!0),t.prev=4,t.next=7,this.context.apis.asyncGetData(this.context.userInfo.token,"evoucher",e);case 7:if(n=t.sent){t.next=10;break}return t.abrupt("return",this.context.alert(this.context.apis.getLabel("Mã thẻ giảm giá này không có giá trị")));case 10:if(!n.id_ct_used){t.next=12;break}return t.abrupt("return",this.context.alert(this.context.apis.getLabel("Mã thẻ giảm giá này đã được sử dụng")));case 12:if(r=g()(n.hieu_luc_tu).startOf("date").toDate().getTime(),a=g()(n.hieu_luc_den).endOf("date").toDate().getTime(),!((o=g()().toDate().getTime())<r||o>a)){t.next=17;break}return t.abrupt("return",this.context.alert(this.context.apis.getLabel("Mã thẻ giảm giá này đã hết hạn sử dụng")));case 17:if(!n.user){t.next=25;break}if(this.ma_kh){t.next=20;break}return t.abrupt("return",this.context.alert(this.context.apis.getLabel("Mã thẻ giảm giá này không có giá trị với khách hàng này")));case 20:return t.next=22,this.context.apis.asyncGetData(this.context.userInfo.token,"customer",{ma_kh:this.ma_kh},"of_user");case 22:if(i=t.sent,n.user==i){t.next=25;break}return t.abrupt("return",this.context.alert(this.context.apis.getLabel("Mã thẻ giảm giá này không có giá trị với khách hàng này")));case 25:this.context.setProgressStatus(!1),this.callback&&this.callback(n),t.next=32;break;case 29:t.prev=29,t.t0=t.catch(4),this.context.alert(t.t0.message||"Không thể kết nối với máy chủ");case 32:this.close();case 33:case"end":return t.stop()}}),t,this,[[4,29]])})),y=function(){var t=this,e=arguments;return new Promise((function(n,r){var a=c.apply(t,e);function o(t){v(a,n,r,o,i,"next",t)}function i(t){v(a,n,r,o,i,"throw",t)}o(void 0)}))},function(){return y.apply(this,arguments)})},{key:"handleValueChanged",value:function(t){this.setState({evoucher_code:(t||"").toUpperCase()})}},{key:"render",value:function(){var t=this;if(!this.state.open)return null;var e=this.state.evoucher_code;return a.a.createElement(l.a,{maxWidth:"sm",fullWidth:!0,open:this.state.open,onClose:this.close.bind(this)},a.a.createElement(f.a,{style:{backgroundColor:d.formHeaderColor,color:d.mainTextColor}},a.a.createElement("div",{style:{display:"flex",alignItems:"center"}},a.a.createElement("div",{style:{flexGrow:1}},a.a.createElement(u.a,null,this.state.title)),a.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingLeft:10}},a.a.createElement(o.a,{style:{marginLeft:5},onClick:function(){return t.setState({open:!1})}},a.a.createElement(s.a,{style:{color:"silver"}}))))),a.a.createElement(h.a,{style:{padding:0}},a.a.createElement(p.a,{margin:"normal",variant:"outlined",fullWidth:!0,type:"text",label:"",autoFocus:!0,multiline:!0,value:e,InputLabelProps:{shrink:!0},onChange:function(e){return t.handleValueChanged(e.target.value)}}),a.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:10}},a.a.createElement(i.a,{variant:"contained",onClick:this.add.bind(this)},this.context.apis.getLabel("Thêm")))))}}])&&x(e.prototype,n),r&&x(e,r),b}(r.Component);O.contextType=y.a,e.default=O}}]);