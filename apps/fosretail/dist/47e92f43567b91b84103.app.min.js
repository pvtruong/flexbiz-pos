(window.webpackJsonp=window.webpackJsonp||[]).push([[19,31],{1086:function(e,t,a){"use strict";var n=a(2),r=a(3),c=a(0),i=(a(1),a(4)),o=a(235),l=a(80),s=Object(l.a)(c.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),h=Object(l.a)(c.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),d=a(17),m=Object(l.a)(c.createElement("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),g=a(9),u=a(6),p=c.createElement(h,null),_=c.createElement(s,null),E=c.createElement(m,null),y=c.forwardRef((function(e,t){var a=e.checkedIcon,l=void 0===a?p:a,s=e.classes,h=e.color,d=void 0===h?"secondary":h,m=e.icon,u=void 0===m?_:m,y=e.indeterminate,f=void 0!==y&&y,v=e.indeterminateIcon,k=void 0===v?E:v,b=e.inputProps,x=e.size,C=void 0===x?"medium":x,O=Object(r.a)(e,["checkedIcon","classes","color","icon","indeterminate","indeterminateIcon","inputProps","size"]),w=f?k:u,T=f?k:l;return c.createElement(o.a,Object(n.a)({type:"checkbox",classes:{root:Object(i.a)(s.root,s["color".concat(Object(g.a)(d))],f&&s.indeterminate),checked:s.checked,disabled:s.disabled},color:d,inputProps:Object(n.a)({"data-indeterminate":f},b),icon:c.cloneElement(w,{fontSize:void 0===w.props.fontSize&&"small"===C?C:w.props.fontSize}),checkedIcon:c.cloneElement(T,{fontSize:void 0===T.props.fontSize&&"small"===C?C:T.props.fontSize}),ref:t},O))}));t.a=Object(u.a)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},indeterminate:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(d.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(d.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiCheckbox"})(y)},1354:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(1),i=a.n(c),o=a(106),l=a(633),s=a(1086),h=a(135),d=a(711),m=a(701),g=a(629),u=a(632),p=a(730),_=a(7),E=a(26),y=a(228),f=a.n(y),v=a(15),k=a.n(v);class b extends r.a.Component{constructor(e){super(e),this.state={dialogOpen:!1,menu:[],groups:[],selectedGroup:null,dialogTrangThaiOpen:!1},this.showForm=this.showForm.bind(this),this.showTrangThai=this.showTrangThai.bind(this)}async componentDidMount(){}async loadright(e){const{asyncGetList:t,asyncGetMenu:a}=this.context.apis;this.context.setProgressStatus(!0);try{this.cac_trang_thai=await t(this.context.userInfo.token,"trangthai",{limit:3e4});const n=(await a(this.context.userInfo.token,e)).filter(e=>!e.system&&"home"!==e.code);n.forEach(e=>{e.cac_trang_thai_phan_quyen=[...this.cac_trang_thai.filter(t=>t.ma_ct.toUpperCase()===e.api_code.toUpperCase())]});const r=[...new Set(n.filter(e=>!e.mother_module).map(e=>e.group))],c=r.length>0?r[0]:null;this.setState({menu:n,groups:r,selectedGroup:c}),this.context.setProgressStatus(!1)}catch(e){console.error(this.context.userInfo),this.context.alert(e.message)}}async showForm(e,t=""){this.setState({dialogOpen:!0,group_id:e,group_name:t,menu:[],groups:[],selectedGroup:null},()=>{this.loadright(e)})}showTrangThai(e,t){const a=[...this.cac_trang_thai.filter(t=>t.ma_ct.toUpperCase()===e.api_code.toUpperCase())];a.forEach(a=>{console.log(e[t+"_trang_thai"],a.ma_trang_thai),a.check=(e[t+"_trang_thai"]||{})[a.ma_trang_thai],null==a.check&&(a.check=!0)}),e["cac_trang_thai_phan_quyen_"+t]=a,this.setState({currentItem:e,currentRight:t,dialogTrangThaiOpen:!0})}handleClose(){this.setState({dialogOpen:!1})}cancel(){this.setState({dialogOpen:!1})}async handleValueChanged(e,t){const{asyncUpdateRight:a}=this.context.apis;try{this.context.setProgressStatus(!0);let n={...t};n._id=e._id,n.email=e.email||this.state.group_id,n.module=e.api_code.toLowerCase();for(let a in t){let r=a+"_trang_thai";n[r]=k.a.cloneDeep(e[r]||{}),e.cac_trang_thai_phan_quyen.forEach(e=>{n[r][e.ma_trang_thai]=t[a]})}let r=await a(this.context.userInfo.token,n);for(let t in n)e[t]=n[t];e._id=r._id,this.state.menu.filter(t=>t.api_code===e.api_code).forEach(e=>{for(let t in n)e[t]=n[t];e._id=r._id}),this.setState({menu:this.state.menu}),this.context.setProgressStatus(!1)}catch(e){this.context.alert(e.message)}}async handleTrangThaiChanged(e,t){let a=this.state.currentItem;const{asyncUpdateRight:n}=this.context.apis;this.context.setProgressStatus(!0);try{e.check=t;let r={},c=this.state.currentRight+"_trang_thai";r[c]=k.a.cloneDeep(a[c]||{}),r[c][e.ma_trang_thai]=t,r._id=a._id,r.email=a.email||this.state.group,r.module=a.api_code.toLowerCase();let i=await n(this.context.userInfo.token,r);a[c]=r[c],a._id=i._id,this.state.menu.filter(e=>e.api_code===a.api_code).forEach(e=>{for(let t in r)e[t]=r[t];e._id=i._id}),this.setState({menu:this.state.menu}),this.context.setProgressStatus(!1)}catch(a){e.check=!t,this.context.alert(a.message)}}dialog(){let{groups:e,selectedGroup:t,currentItem:a}=this.state;const{getLabel:n}=this.context.apis,{formHeaderColor:c,mainTextColor:i}=this.context.config;return r.a.createElement(g.a,{fullScreen:this.props.mediaQueryMatches,fullWidth:!0,maxWidth:"lg",open:this.state.dialogOpen,onClose:()=>this.cancel()},r.a.createElement(p.a,{style:{backgroundColor:c,color:i}},r.a.createElement(m.a,{container:!0,direction:"row",justify:"space-between"},r.a.createElement(m.a,{item:!0},n("Phân quyền")," : ",this.state.group_name),r.a.createElement(m.a,{item:!0},r.a.createElement(l.a,{onClick:()=>this.cancel(),style:{color:i}},r.a.createElement(f.a,{style:{color:"silver"}}))))),r.a.createElement(u.a,null,r.a.createElement(m.a,{container:!0},r.a.createElement(m.a,{item:!0,md:3},r.a.createElement(h.a,{elevation:1,style:{margin:10,padding:10}},e.map(e=>r.a.createElement(l.a,{style:{marginBottom:10},variant:"outlined",color:e===t?"secondary":"primary",fullWidth:!0,key:e.toString(),onClick:()=>{this.setState({selectedGroup:e})}},n(e))))),r.a.createElement(m.a,{item:!0,md:9},r.a.createElement(h.a,{elevation:0,style:{margin:10}},!!t&&r.a.createElement(r.a.Fragment,null,this.state.menu.filter(e=>e.group===t||e.name_mother_module===t).map((e,t)=>r.a.createElement(h.a,{key:t.toString(),style:{padding:10,marginBottom:10}},r.a.createElement(o.a,{variant:"title",component:"h5"},n(e.title)),r.a.createElement(m.a,{container:!0,spacing:1},r.a.createElement(m.a,{item:!0,xs:12,sm:12,md:2,lg:2},(!e.rights||e.rights.indexOf("view")>=0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{control:r.a.createElement(s.a,{value:e.view,color:"secondary",checked:e.view,onChange:t=>this.handleValueChanged(e,{view:t.target.checked})}),label:n("Xem")}),e.cac_trang_thai_phan_quyen.length>0&&e.view&&r.a.createElement("div",null,r.a.createElement(l.a,{size:"small",variant:"outlined",onClick:()=>this.showTrangThai(e,"view")},n("Trạng thái"))))),r.a.createElement(m.a,{item:!0,xs:12,sm:12,md:3,lg:3},(!e.rights||e.rights.indexOf("viewOfOther")>=0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{control:r.a.createElement(s.a,{value:e.viewOfOther,color:"secondary",checked:e.viewOfOther,onChange:t=>this.handleValueChanged(e,{viewOfOther:t.target.checked})}),label:n("Xem của người khác")}))),r.a.createElement(m.a,{item:!0,xs:12,sm:12,md:3,lg:3},(!e.rights||e.rights.indexOf("add")>=0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{control:r.a.createElement(s.a,{value:e.add,color:"secondary",checked:e.add,onChange:t=>this.handleValueChanged(e,{add:t.target.checked})}),label:n("Thêm mới")}),e.cac_trang_thai_phan_quyen.length>0&&e.add&&r.a.createElement("div",null,r.a.createElement(l.a,{size:"small",variant:"outlined",onClick:()=>this.showTrangThai(e,"add")},n("Trạng thái"))))),r.a.createElement(m.a,{item:!0,xs:12,sm:12,md:2,lg:2},(!e.rights||e.rights.indexOf("update")>=0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{control:r.a.createElement(s.a,{value:e.update,color:"secondary",checked:e.update,onChange:t=>this.handleValueChanged(e,{update:t.target.checked})}),label:n("Cập nhật")}),e.cac_trang_thai_phan_quyen.length>0&&e.update&&r.a.createElement("div",null,r.a.createElement(l.a,{size:"small",variant:"outlined",onClick:()=>this.showTrangThai(e,"update")},n("Trạng thái"))))),r.a.createElement(m.a,{item:!0,xs:12,sm:12,md:2,lg:2},(!e.rights||e.rights.indexOf("delete")>=0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{control:r.a.createElement(s.a,{value:e.delete,color:"secondary",checked:e.delete,onChange:t=>this.handleValueChanged(e,{delete:t.target.checked})}),label:n("Xoá")}),e.cac_trang_thai_phan_quyen.length>0&&e.delete&&r.a.createElement("div",null,r.a.createElement(l.a,{size:"small",variant:"outlined",onClick:()=>this.showTrangThai(e,"delete")},n("Trạng thái")))))))))))),r.a.createElement(g.a,{fullScreen:this.props.mediaQueryMatches,fullWidth:!0,maxWidth:"sm",open:this.state.dialogTrangThaiOpen,onClose:()=>this.setState({dialogTrangThaiOpen:!1})},r.a.createElement(p.a,{style:{backgroundColor:c,color:i}},r.a.createElement(m.a,{container:!0,direction:"row",justify:"space-between"},r.a.createElement(m.a,{item:!0},n("Trạng thái có quyền")),r.a.createElement(m.a,{item:!0},r.a.createElement(l.a,{onClick:()=>this.setState({dialogTrangThaiOpen:!1}),style:{color:i}},"x")))),r.a.createElement(u.a,null,!!a&&a["cac_trang_thai_phan_quyen_"+this.state.currentRight].map(e=>r.a.createElement("div",{key:e.ma_trang_thai},r.a.createElement(d.a,{control:r.a.createElement(s.a,{value:e.check,color:"secondary",checked:e.check,onChange:t=>this.handleTrangThaiChanged(e,t.target.checked)}),label:n(e.ten_trang_thai)})))))))}render(){return this.dialog()}}b.contextType=_.a,b.propTypes={mediaQueryMatches:i.a.bool},t.default=Object(E.a)("(max-width:480px)")(b)},730:function(e,t,a){"use strict";var n=a(2),r=a(3),c=a(0),i=(a(1),a(4)),o=a(6),l=a(106),s=c.forwardRef((function(e,t){var a=e.children,o=e.classes,s=e.className,h=e.disableTypography,d=void 0!==h&&h,m=Object(r.a)(e,["children","classes","className","disableTypography"]);return c.createElement("div",Object(n.a)({className:Object(i.a)(o.root,s),ref:t},m),d?a:c.createElement(l.a,{component:"h2",variant:"h6"},a))}));t.a=Object(o.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(s)}}]);