(window.webpackJsonp=window.webpackJsonp||[]).push([[13,4,17,31],{1367:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(338),i=n(633),l=n(228),c=n.n(l),s=n(106),d=n(629),u=n(632),f=n(730),h=n(135),p=n(1),b=n.n(p),m=n(866),v=n(701),g=n(715),y=n(7),k=n(10),x=n(795);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=S(e);if(t){var r=S(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return O(this,n)}}function O(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(p,e);var t,n,a,l=E(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=l.call(this,e)).handleValueChanged=t.handleValueChanged.bind(j(t)),t.handleTyLeCkChanged=t.handleTyLeCkChanged.bind(j(t)),t.handleTienCkChanged=t.handleTienCkChanged.bind(j(t)),t.state={load:0,open:t.props.open,disabled_discount:!0,data:{},kho:null},t}return t=p,(n=[{key:"open",value:function(e,t,n){this.callback=n,this.setState({data:e,kho:t,open:!0,disabled_discount:!0})}},{key:"close",value:function(){this.setState({open:!1})}},{key:"save",value:function(){if(!(this.state.data||{}).ma_ban)return this.context.alert(this.context.apis.getLabel("Bạn phải chọn một bàn"));this.callback&&this.callback(this.state.data),this.setState({open:!1,disabled_discount:!0})}},{key:"handleValueChanged",value:function(e){var t=this.state.data;for(var n in e)t[n]=e[n];this.setState({data:t,load:this.state.load+1})}},{key:"handleTyLeCkChanged",value:function(e){var t=this.state.data,n=(t.details||[]).map((function(e){return(e.tien_hang_nt||0)-(e.tien_ck_nt||0)})).reduce((function(e,t){return e+t}),0);t.ty_le_ck_hd=e,t.tien_ck_hd=Math.round(n*t.ty_le_ck_hd/100,0),t.t_ck_nt=t.tien_ck_hd+(t.details||[]).map((function(e){return e.tien_ck_nt})).reduce((function(e,t){return e+t}),0),this.setState({data:t,load:this.state.load+1})}},{key:"handleTienCkChanged",value:function(e){console.log("tien ck hd changed",e);var t=this.state.data;t.tien_ck_hd=Number(e),t.ty_le_ck_hd=0,t.t_ck_nt=t.tien_ck_hd+(t.details||[]).map((function(e){return e.tien_ck_nt})).reduce((function(e,t){return e+t}),0),this.setState({data:t,load:this.state.load+1})}},{key:"editDiscount",value:function(){var e=this,t=this.state,n=t.kho,a=t.data;if(!n.user_quan_ly)return this.context.alert(this.context.apis.getLabel("Chưa khai báo người quản lý cho cửa hàng này"));var r={time:new Date,id_app:this.context.config.id_app};this.context.sign("Nhập mật khẩu để ký xác nhận thay đổi chiết khấu",n.user_quan_ly,r,(function(t){a.sign_user=n.user_quan_ly,a.sign_data=r,a.signature=t,e.setState({disabled_discount:!1})}))}},{key:"render",value:function(){var e=this;if(!this.state.open)return null;var t=this.state,n=t.data,a=t.disabled_discount,l=[{type:"String",maxlength:32,required:!0,name:"ma_ban",header:"Bàn",ref_model:"dmban",ref_field:"ma_ban",ref_label:"ten_ban",ref_condition:'{"ma_kho":"'.concat(n.ma_kho,'"}'),html_component_input:"picker"},{type:"String",maxlength:32,required:!1,name:"ma_kh",header:"Khách hàng",ref_model:"customer",ref_field:"ma_kh",ref_label:"ten_kh"},{type:"String",maxlength:1024,required:!1,name:"ong_ba",header:"Người giao dịch"},{type:"Number",required:!0,name:"so_khach",header:"Số khách"},{type:"String",maxlength:1024,required:!1,name:"dien_giai",header:"Ghi chú",grid_configs:"{lg:12,md:12}",html_component_input:"textarea"}];return r.a.createElement(d.a,{maxWidth:"sm",fullWidth:!0,open:this.state.open},r.a.createElement(f.a,{style:{backgroundColor:k.formHeaderColor,color:k.mainTextColor}},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement("div",{style:{flexGrow:1}},r.a.createElement(s.a,null,this.state.title||this.context.apis.getLabel("Cập nhật phiếu"))),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingLeft:10}},r.a.createElement(o.a,{style:{marginLeft:5},onClick:function(){return e.setState({open:!1})}},r.a.createElement(c.a,{style:{color:"silver"}}))))),r.a.createElement(u.a,{style:{padding:0}},r.a.createElement(h.a,{style:{margin:10,padding:10}},r.a.createElement("div",null,r.a.createElement(x.default,{fields:l,master:n,data:n,handleValueChanged:this.handleValueChanged.bind(this)}))),r.a.createElement(h.a,{style:{margin:10,padding:10}},r.a.createElement(v.a,{container:!0},r.a.createElement(v.a,{item:!0},r.a.createElement(g.a,{margin:"normal",variant:"standard",type:"text",id:"ty_le_ck_hd",label:this.context.apis.getLabel("Tỷ lệ CK hoá đơn"),value:n.ty_le_ck_hd,disabled:a,InputLabelProps:{shrink:!0},InputProps:{inputComponent:m.a},onChange:function(t){return e.handleTyLeCkChanged(Number(t.target.value))}})),r.a.createElement(v.a,{item:!0,style:{flexGrow:1,paddingLeft:10,paddingRight:10}},r.a.createElement(g.a,{fullWidth:!0,margin:"normal",variant:"standard",type:"text",id:"tien_ck_hd",label:this.context.apis.getLabel("Tiền chiết khấu hoá đơn"),value:n.tien_ck_hd,disabled:a,InputLabelProps:{shrink:!0},InputProps:{inputComponent:m.a},onChange:function(t){return e.handleTienCkChanged(t.target.value)}})),a&&r.a.createElement(v.a,{item:!0,style:{display:"flex",alignItems:"flex-end"}},r.a.createElement(i.a,{variant:"contained",onClick:this.editDiscount.bind(this)},this.context.apis.getLabel("Sửa"))))),r.a.createElement("div",{style:{display:"flex",justifyContent:"center",padding:10}},r.a.createElement(i.a,{variant:"contained",color:"secondary",onClick:this.save.bind(this)},this.context.apis.getLabel("Lưu")))))}}])&&C(t.prototype,n),a&&C(t,a),p}(a.PureComponent);L.contextType=y.a,L.propTypes={open:b.a.bool},t.default=L},730:function(e,t,n){"use strict";var a=n(2),r=n(3),o=n(0),i=(n(1),n(4)),l=n(6),c=n(106),s=o.forwardRef((function(e,t){var n=e.children,l=e.classes,s=e.className,d=e.disableTypography,u=void 0!==d&&d,f=Object(r.a)(e,["children","classes","className","disableTypography"]);return o.createElement("div",Object(a.a)({className:Object(i.a)(l.root,s),ref:t},f),u?n:o.createElement(c.a,{component:"h2",variant:"h6"},n))}));t.a=Object(l.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(s)},740:function(e,t,n){"use strict";var a=n(0),r=n(80);t.a=Object(r.a)(a.createElement("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},741:function(e,t,n){"use strict";var a=n(0),r=n(80);t.a=Object(r.a)(a.createElement("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},802:function(e,t,n){"use strict";var a=n(3),r=n(25),o=n(2),i=n(0),l=(n(1),n(4)),c=n(6),s=n(172),d=n(9),u=i.forwardRef((function(e,t){var n=e.classes,r=e.className,c=e.disabled,u=void 0!==c&&c,f=e.disableFocusRipple,h=void 0!==f&&f,p=e.fullWidth,b=e.icon,m=e.indicator,v=e.label,g=e.onChange,y=e.onClick,k=e.onFocus,x=e.selected,_=e.selectionFollowsFocus,C=e.textColor,w=void 0===C?"inherit":C,E=e.value,O=e.wrapped,j=void 0!==O&&O,S=Object(a.a)(e,["classes","className","disabled","disableFocusRipple","fullWidth","icon","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"]);return i.createElement(s.a,Object(o.a)({focusRipple:!h,className:Object(l.a)(n.root,n["textColor".concat(Object(d.a)(w))],r,u&&n.disabled,x&&n.selected,v&&b&&n.labelIcon,p&&n.fullWidth,j&&n.wrapped),ref:t,role:"tab","aria-selected":x,disabled:u,onClick:function(e){g&&g(e,E),y&&y(e)},onFocus:function(e){_&&!x&&g&&g(e,E),k&&k(e)},tabIndex:x?0:-1},S),i.createElement("span",{className:n.wrapper},b,v),m)}));t.a=Object(c.a)((function(e){var t;return{root:Object(o.a)({},e.typography.button,(t={maxWidth:264,minWidth:72,position:"relative",boxSizing:"border-box",minHeight:48,flexShrink:0,padding:"6px 12px"},Object(r.a)(t,e.breakpoints.up("sm"),{padding:"6px 24px"}),Object(r.a)(t,"overflow","hidden"),Object(r.a)(t,"whiteSpace","normal"),Object(r.a)(t,"textAlign","center"),Object(r.a)(t,e.breakpoints.up("sm"),{minWidth:160}),t)),labelIcon:{minHeight:72,paddingTop:9,"& $wrapper > *:first-child":{marginBottom:6}},textColorInherit:{color:"inherit",opacity:.7,"&$selected":{opacity:1},"&$disabled":{opacity:.5}},textColorPrimary:{color:e.palette.text.secondary,"&$selected":{color:e.palette.primary.main},"&$disabled":{color:e.palette.text.disabled}},textColorSecondary:{color:e.palette.text.secondary,"&$selected":{color:e.palette.secondary.main},"&$disabled":{color:e.palette.text.disabled}},selected:{},disabled:{},fullWidth:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},wrapped:{fontSize:e.typography.pxToRem(12),lineHeight:1.5},wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"100%",flexDirection:"column"}}}),{name:"MuiTab"})(u)},857:function(e,t,n){"use strict";var a,r=n(2),o=n(3),i=n(25),l=n(0),c=(n(137),n(1),n(4)),s=n(81),d=n(107);function u(){if(a)return a;var e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),a="reverse",e.scrollLeft>0?a="default":(e.scrollLeft=1,0===e.scrollLeft&&(a="negative")),document.body.removeChild(e),a}function f(e,t){var n=e.scrollLeft;if("rtl"!==t)return n;switch(u()){case"negative":return e.scrollWidth-e.clientWidth+n;case"reverse":return e.scrollWidth-e.clientWidth-n;default:return n}}function h(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}var p={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function b(e){var t=e.onChange,n=Object(o.a)(e,["onChange"]),a=l.useRef(),i=l.useRef(null),c=function(){a.current=i.current.offsetHeight-i.current.clientHeight};return l.useEffect((function(){var e=Object(s.a)((function(){var e=a.current;c(),e!==a.current&&t(a.current)}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}),[t]),l.useEffect((function(){c(),t(a.current)}),[t]),l.createElement("div",Object(r.a)({style:p,ref:i},n))}var m=n(6),v=n(9),g=l.forwardRef((function(e,t){var n=e.classes,a=e.className,i=e.color,s=e.orientation,d=Object(o.a)(e,["classes","className","color","orientation"]);return l.createElement("span",Object(r.a)({className:Object(c.a)(n.root,n["color".concat(Object(v.a)(i))],a,"vertical"===s&&n.vertical),ref:t},d))})),y=Object(m.a)((function(e){return{root:{position:"absolute",height:2,bottom:0,width:"100%",transition:e.transitions.create()},colorPrimary:{backgroundColor:e.palette.primary.main},colorSecondary:{backgroundColor:e.palette.secondary.main},vertical:{height:"100%",width:2,right:0}}}),{name:"PrivateTabIndicator"})(g),k=n(740),x=n(741),_=n(172),C=l.createElement(k.a,{fontSize:"small"}),w=l.createElement(x.a,{fontSize:"small"}),E=l.forwardRef((function(e,t){var n=e.classes,a=e.className,i=e.direction,s=e.orientation,d=e.disabled,u=Object(o.a)(e,["classes","className","direction","orientation","disabled"]);return l.createElement(_.a,Object(r.a)({component:"div",className:Object(c.a)(n.root,a,d&&n.disabled,"vertical"===s&&n.vertical),ref:t,role:null,tabIndex:null},u),"left"===i?C:w)})),O=Object(m.a)({root:{width:40,flexShrink:0,opacity:.8,"&$disabled":{opacity:0}},vertical:{width:"100%",height:40,"& svg":{transform:"rotate(90deg)"}},disabled:{}},{name:"MuiTabScrollButton"})(E),j=n(45),S=n(31),L=l.forwardRef((function(e,t){var n=e["aria-label"],a=e["aria-labelledby"],p=e.action,m=e.centered,v=void 0!==m&&m,g=e.children,k=e.classes,x=e.className,_=e.component,C=void 0===_?"div":_,w=e.indicatorColor,E=void 0===w?"secondary":w,L=e.onChange,N=e.orientation,T=void 0===N?"horizontal":N,B=e.ScrollButtonComponent,W=void 0===B?O:B,R=e.scrollButtons,I=void 0===R?"auto":R,M=e.selectionFollowsFocus,P=e.TabIndicatorProps,F=void 0===P?{}:P,z=e.TabScrollButtonProps,A=e.textColor,D=void 0===A?"inherit":A,q=e.value,H=e.variant,V=void 0===H?"standard":H,$=Object(o.a)(e,["aria-label","aria-labelledby","action","centered","children","classes","className","component","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant"]),K=Object(S.a)(),G="scrollable"===V,J="rtl"===K.direction,X="vertical"===T,U=X?"scrollTop":"scrollLeft",Q=X?"top":"left",Y=X?"bottom":"right",Z=X?"clientHeight":"clientWidth",ee=X?"height":"width";var te=l.useState(!1),ne=te[0],ae=te[1],re=l.useState({}),oe=re[0],ie=re[1],le=l.useState({start:!1,end:!1}),ce=le[0],se=le[1],de=l.useState({overflow:"hidden",marginBottom:null}),ue=de[0],fe=de[1],he=new Map,pe=l.useRef(null),be=l.useRef(null),me=function(){var e,t,n=pe.current;if(n){var a=n.getBoundingClientRect();e={clientWidth:n.clientWidth,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop,scrollLeftNormalized:f(n,K.direction),scrollWidth:n.scrollWidth,top:a.top,bottom:a.bottom,left:a.left,right:a.right}}if(n&&!1!==q){var r=be.current.children;if(r.length>0){var o=r[he.get(q)];0,t=o?o.getBoundingClientRect():null}}return{tabsMeta:e,tabMeta:t}},ve=Object(j.a)((function(){var e,t=me(),n=t.tabsMeta,a=t.tabMeta,r=0;if(a&&n)if(X)r=a.top-n.top+n.scrollTop;else{var o=J?n.scrollLeftNormalized+n.clientWidth-n.scrollWidth:n.scrollLeft;r=a.left-n.left+o}var l=(e={},Object(i.a)(e,Q,r),Object(i.a)(e,ee,a?a[ee]:0),e);if(isNaN(oe[Q])||isNaN(oe[ee]))ie(l);else{var c=Math.abs(oe[Q]-l[Q]),s=Math.abs(oe[ee]-l[ee]);(c>=1||s>=1)&&ie(l)}})),ge=function(e){!function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=a.ease,i=void 0===o?h:o,l=a.duration,c=void 0===l?300:l,s=null,d=t[e],u=!1,f=function(){u=!0},p=function a(o){if(u)r(new Error("Animation cancelled"));else{null===s&&(s=o);var l=Math.min(1,(o-s)/c);t[e]=i(l)*(n-d)+d,l>=1?requestAnimationFrame((function(){r(null)})):requestAnimationFrame(a)}};d===n?r(new Error("Element already at target position")):requestAnimationFrame(p)}(U,pe.current,e)},ye=function(e){var t=pe.current[U];X?t+=e:(t+=e*(J?-1:1),t*=J&&"reverse"===u()?-1:1),ge(t)},ke=function(){ye(-pe.current[Z])},xe=function(){ye(pe.current[Z])},_e=l.useCallback((function(e){fe({overflow:null,marginBottom:-e})}),[]),Ce=Object(j.a)((function(){var e=me(),t=e.tabsMeta,n=e.tabMeta;if(n&&t)if(n[Q]<t[Q]){var a=t[U]+(n[Q]-t[Q]);ge(a)}else if(n[Y]>t[Y]){var r=t[U]+(n[Y]-t[Y]);ge(r)}})),we=Object(j.a)((function(){if(G&&"off"!==I){var e,t,n=pe.current,a=n.scrollTop,r=n.scrollHeight,o=n.clientHeight,i=n.scrollWidth,l=n.clientWidth;if(X)e=a>1,t=a<r-o-1;else{var c=f(pe.current,K.direction);e=J?c<i-l-1:c>1,t=J?c>1:c<i-l-1}e===ce.start&&t===ce.end||se({start:e,end:t})}}));l.useEffect((function(){var e=Object(s.a)((function(){ve(),we()})),t=Object(d.a)(pe.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}}),[ve,we]);var Ee=l.useCallback(Object(s.a)((function(){we()})));l.useEffect((function(){return function(){Ee.clear()}}),[Ee]),l.useEffect((function(){ae(!0)}),[]),l.useEffect((function(){ve(),we()})),l.useEffect((function(){Ce()}),[Ce,oe]),l.useImperativeHandle(p,(function(){return{updateIndicator:ve,updateScrollButtons:we}}),[ve,we]);var Oe=l.createElement(y,Object(r.a)({className:k.indicator,orientation:T,color:E},F,{style:Object(r.a)({},oe,F.style)})),je=0,Se=l.Children.map(g,(function(e){if(!l.isValidElement(e))return null;var t=void 0===e.props.value?je:e.props.value;he.set(t,je);var n=t===q;return je+=1,l.cloneElement(e,{fullWidth:"fullWidth"===V,indicator:n&&!ne&&Oe,selected:n,selectionFollowsFocus:M,onChange:L,textColor:D,value:t})})),Le=function(){var e={};e.scrollbarSizeListener=G?l.createElement(b,{className:k.scrollable,onChange:_e}):null;var t=ce.start||ce.end,n=G&&("auto"===I&&t||"desktop"===I||"on"===I);return e.scrollButtonStart=n?l.createElement(W,Object(r.a)({orientation:T,direction:J?"right":"left",onClick:ke,disabled:!ce.start,className:Object(c.a)(k.scrollButtons,"on"!==I&&k.scrollButtonsDesktop)},z)):null,e.scrollButtonEnd=n?l.createElement(W,Object(r.a)({orientation:T,direction:J?"left":"right",onClick:xe,disabled:!ce.end,className:Object(c.a)(k.scrollButtons,"on"!==I&&k.scrollButtonsDesktop)},z)):null,e}();return l.createElement(C,Object(r.a)({className:Object(c.a)(k.root,x,X&&k.vertical),ref:t},$),Le.scrollButtonStart,Le.scrollbarSizeListener,l.createElement("div",{className:Object(c.a)(k.scroller,G?k.scrollable:k.fixed),style:ue,ref:pe,onScroll:Ee},l.createElement("div",{"aria-label":n,"aria-labelledby":a,className:Object(c.a)(k.flexContainer,X&&k.flexContainerVertical,v&&!G&&k.centered),onKeyDown:function(e){var t=e.target;if("tab"===t.getAttribute("role")){var n=null,a="vertical"!==T?"ArrowLeft":"ArrowUp",r="vertical"!==T?"ArrowRight":"ArrowDown";switch("vertical"!==T&&"rtl"===K.direction&&(a="ArrowRight",r="ArrowLeft"),e.key){case a:n=t.previousElementSibling||be.current.lastChild;break;case r:n=t.nextElementSibling||be.current.firstChild;break;case"Home":n=be.current.firstChild;break;case"End":n=be.current.lastChild}null!==n&&(n.focus(),e.preventDefault())}},ref:be,role:"tablist"},Se),ne&&Oe),Le.scrollButtonEnd)}));t.a=Object(m.a)((function(e){return{root:{overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},vertical:{flexDirection:"column"},flexContainer:{display:"flex"},flexContainerVertical:{flexDirection:"column"},centered:{justifyContent:"center"},scroller:{position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},fixed:{overflowX:"hidden",width:"100%"},scrollable:{overflowX:"scroll",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},scrollButtons:{},scrollButtonsDesktop:Object(i.a)({},e.breakpoints.down("xs"),{display:"none"}),indicator:{}}}),{name:"MuiTabs"})(L)}}]);