(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{1733:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(55),o=n.n(s),i=n(1703),c=n(1755),l=n(480),u=n(1714),d=n(1715),p=n(437),h=n(374),f=n(403),g=n(397),m=n.n(g);const x=n(543),w={paper:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:1},submit:{margin:"3 0 2 0"}};class v extends r.a.Component{constructor(e){super(e),this.state={refreshing:!1,dialogOpen:!1,email:"",password:"",rePassword:"",address:"",phone:"",name:""},this.submit=this.submit.bind(this),this.showForm=this.showForm.bind(this),this.createUserGoogle=this.createUserGoogle.bind(this),this.createUserFacebook=this.createUserFacebook.bind(this)}async componentDidMount(){const{getLabel:e}=this.context.apis;this.constraints={email:{presence:{allowEmpty:!1,message:"^"+e("Bạn chưa nhập số điện thoại hoặc email")}},name:{presence:{allowEmpty:!1,message:"^"+e("Bạn chưa nhập họ và tên đầy đủ")}},address:{presence:{allowEmpty:!0,message:"^"+e("Bạn chưa nhập địa chỉ")}},phone:{presence:{allowEmpty:!0,message:"^"+e("Bạn chưa nhập số điện thoại để liên hệ")}},password:{presence:{allowEmpty:!1,message:"^"+e("Bạn chưa nhập mật khẩu")},length:{minimum:6,message:"^"+e("Mật khẩu phải ít nhất 6 ký tự")}},rePassword:{presence:{allowEmpty:!1,message:"^"+e("Bạn chưa nhập xác nhận mật khẩu")},equality:{attribute:"password",message:"^"+e("Hai mật khẩu không khớp nhau")}}}}showForm(e,t,n){let a={dialogOpen:!0,error:"",email:"",password:"",rePassword:"",address:"",phone:"",name:"",rs:"",running:!1,google_id_token:"",facebook_token:""};e&&(a=Object.assign(a,e)),this.setState(a),this.onSuccess=t,this.onCancel=n}handleClose(){this.setState({dialogOpen:!1})}handleCancel(){this.setState({dialogOpen:!1},()=>{this.onCancel&&this.onCancel()})}async createUserGoogle(e){e.picture=this.state.picture;let t=`${this.context.config.server_url}/createUser/google?id_app=${this.context.config.id_app}&group_id=${this.context.config.group_id}&id_token=${this.state.google_id_token}&email=${e.email}&password=${e.password}`;try{let n=JSON.parse(await this.context.apis.asyncGet(t));if(n.error)return void this.setState({error:n.error,running:!1});let a=n.access_token;t=this.context.config.server_url+"/api/updateprofile?access_token="+a,await this.context.apis.asyncPost(t,null,e,"POST","updateProfile"),n=await this.context.apis.asyncGetUserInfoByToken(a),n.token=a,localStorage.setItem("token",a),this.setState({error:"",running:!1,dialogOpen:!1}),this.onSuccess&&this.onSuccess(n)}catch(e){this.setState({error:e.message,running:!1})}}async createUserFacebook(e){e.picture=this.state.picture;let t=`${this.context.config.server_url}/createUser/facebook?id_app=${this.context.config.id_app}&group_id=${this.context.config.group_id}&access_token=${this.state.facebook_token}&email=${e.email}&password=${e.password}`;try{let n=JSON.parse(await this.context.apis.asyncGet(t));if(n.error)return void this.setState({error:n.error,running:!1});let a=this.state.facebook_token;t=this.context.config.server_url+"/api/updateprofile?access_token="+a,await this.context.apis.asyncPost(t,null,e,"updateProfile"),n=await this.context.apis.asyncGetUserInfoByToken(a),n.token=a,localStorage.setItem("token",a),this.setState({error:"",running:!1,dialogOpen:!1}),this.onSuccess&&this.onSuccess(n)}catch(e){this.setState({error:e.message,running:!1})}}onKeyPress(e){"Enter"===e.key&&(this.submit(),e.preventDefault())}async submit(){let e={email:this.state.email,name:this.state.name,password:this.state.password,rePassword:this.state.rePassword,address:this.state.address,phone:this.state.phone,active:!this.context.config.signin_by_phone},t=x(e,this.constraints,{format:"flat"});if(t){let e=t.join("<br/>");this.setState({error:e,running:!1})}else{if(this.setState({running:!0,error:""}),this.context.setProgressStatus(!0),this.state.google_id_token)return this.context.setProgressStatus(!1),await this.createUserGoogle(e);if(this.state.facebook_token)return this.context.setProgressStatus(!1),await this.createUserFacebook(e);try{await this.context.apis.asyncSignup(e)}catch(e){return this.setState({error:e.message,running:!1}),void this.context.setProgressStatus(!1)}try{let t=await this.context.verify({phone:e.email});this.setState({error:"",running:!1,dialogOpen:!1}),this.onSuccess&&this.onSuccess(t)}catch(e){this.setState({error:e.message,running:!1})}this.context.setProgressStatus(!1)}}dialog(){return r.a.createElement(u.a,{fullScreen:this.props.mediaQueryMatches,fullWidth:!0,maxWidth:"sm",open:this.state.dialogOpen},r.a.createElement(p.a,{style:{backgroundColor:this.context.config.formHeaderColor,color:this.context.config.mainTextColor}},r.a.createElement(l.a,{container:!0,direction:"row",justify:"space-between"},r.a.createElement(l.a,{item:!0},this.context.apis.getLabel("Đăng ký tài khoản")),r.a.createElement(l.a,{item:!0},r.a.createElement(i.a,{onClick:()=>this.handleCancel(),style:{color:this.context.config.mainTextColor}},r.a.createElement(m.a,{style:{color:"silver"}}))))),r.a.createElement(d.a,null,r.a.createElement("div",{style:w.paper},r.a.createElement("form",{style:w.form,noValidate:!0},r.a.createElement(c.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:this.context.apis.getLabel("Số điện thoại hoặc email"),disabled:this.state.google_id_token||this.state.facebook_token,autoFocus:!0,value:this.state.email,autoComplete:"new-password",onKeyPress:this.onKeyPress.bind(this),onChange:e=>this.setState({email:e.target.value})}),r.a.createElement(c.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"name",label:this.context.apis.getLabel("Họ và tên đầy đủ"),value:this.state.name,autoComplete:"new-password",onKeyPress:this.onKeyPress.bind(this),onChange:e=>this.setState({name:e.target.value})}),r.a.createElement(c.a,{error:this.state.password&&this.state.password.length<6,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:this.context.apis.getLabel("Mật khẩu"),autoComplete:"new-password",helperText:this.state.password&&this.state.password.length<6?this.context.apis.getLabel("Mật khẩu phải từ 6 ký tự trở lên"):null,type:"password",id:"password",value:this.state.password,onKeyPress:this.onKeyPress.bind(this),onChange:e=>this.setState({password:e.target.value})}),r.a.createElement(c.a,{error:this.state.password&&this.state.rePassword&&this.state.password!==this.state.rePassword,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:this.context.apis.getLabel("Xác nhận mật khẩu"),type:"password",id:"repassword",autoComplete:"new-password",value:this.state.rePassword,helperText:this.state.password&&this.state.rePassword&&this.state.password!==this.state.rePassword?this.context.apis.getLabel("Hai mật khẩu phải giống nhau"):null,onKeyPress:this.onKeyPress.bind(this),onChange:e=>this.setState({rePassword:e.target.value})}),r.a.createElement("div",{style:{color:"red",textAlign:"center",padding:10},dangerouslySetInnerHTML:{__html:this.state.error}}),r.a.createElement(i.a,{type:"Button",fullWidth:!0,variant:"contained",color:"primary",style:w.submit,disabled:this.state.running,onClick:this.submit},this.context.apis.getLabel("Đăng ký"))))))}render(){return this.dialog()}}v.contextType=h.a,v.propTypes={mediaQueryMatches:o.a.bool},t.default=Object(f.a)("(max-width:480px)")(v)},371:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},372:function(e,t,n){var a=n(410).default;function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=s?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n},e.exports.default=e.exports,e.exports.__esModule=!0},373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.createSvgIcon}});var a=n(396)},381:function(e,t,n){"use strict";function a(e,t){return function(){return null}}n.d(t,"a",(function(){return a}))},387:function(e,t,n){"use strict";function a(e){return function(){return null}}n.d(t,"a",(function(){return a}))},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1);function r(e){var t=a.useState(e),n=t[0],r=t[1],s=e||n;return a.useEffect((function(){null==n&&r("mui-".concat(Math.round(1e5*Math.random())))}),[n]),s}},392:function(e,t,n){"use strict";function a(e,t,n,a,r){return null}n.d(t,"a",(function(){return a}))},396:function(e,t,n){"use strict";n.r(t);var a=n(378);n.d(t,"capitalize",(function(){return a.a}));var r=n(407);n.d(t,"createChainedFunction",(function(){return r.a}));var s=n(383);n.d(t,"createSvgIcon",(function(){return s.a}));var o=n(412);n.d(t,"debounce",(function(){return o.a}));var i=n(381);n.d(t,"deprecatedPropType",(function(){return i.a}));var c=n(413);n.d(t,"isMuiElement",(function(){return c.a}));var l=n(404);n.d(t,"ownerDocument",(function(){return l.a}));var u=n(416);n.d(t,"ownerWindow",(function(){return u.a}));var d=n(387);n.d(t,"requirePropFactory",(function(){return d.a}));var p=n(402);n.d(t,"setRef",(function(){return p.a}));var h=n(392);n.d(t,"unsupportedProp",(function(){return h.a}));var f=n(405);n.d(t,"useControlled",(function(){return f.a}));var g=n(406);n.d(t,"useEventCallback",(function(){return g.a}));var m=n(382);n.d(t,"useForkRef",(function(){return m.a}));var x=n(389);n.d(t,"unstable_useId",(function(){return x.a}));var w=n(411);n.d(t,"useIsFocusVisible",(function(){return w.a}))},397:function(e,t,n){"use strict";var a=n(371),r=n(372);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(n(1)),o=(0,a(n(373)).default)(s.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");t.default=o},403:function(e,t,n){"use strict";var a=n(1),r=n.n(a),s=n(55),o=n.n(s),i=n(504);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.a=(...e)=>t=>n=>{const a=Object(i.a)(...e),s=e=>{const{forwardedRef:n,...s}=e;return r.a.createElement(t,c({ref:n},s,{mediaQueryMatches:a}))};return s.propTypes={forwardedRef:o.a.any},r.a.createElement(s,n)}},410:function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},480:function(e,t,n){"use strict";var a=n(368),r=n(12),s=n(1),o=(n(55),n(369)),i=n(370),c=[0,1,2,3,4,5,6,7,8,9,10],l=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=parseFloat(e);return"".concat(n/t).concat(String(e).replace(String(n),"")||"px")}var d=s.forwardRef((function(e,t){var n=e.alignContent,i=void 0===n?"stretch":n,c=e.alignItems,l=void 0===c?"stretch":c,u=e.classes,d=e.className,p=e.component,h=void 0===p?"div":p,f=e.container,g=void 0!==f&&f,m=e.direction,x=void 0===m?"row":m,w=e.item,v=void 0!==w&&w,y=e.justify,b=e.justifyContent,S=void 0===b?"flex-start":b,k=e.lg,_=void 0!==k&&k,P=e.md,j=void 0!==P&&P,C=e.sm,M=void 0!==C&&C,O=e.spacing,E=void 0===O?0:O,W=e.wrap,I=void 0===W?"wrap":W,T=e.xl,F=void 0!==T&&T,L=e.xs,U=void 0!==L&&L,$=e.zeroMinWidth,B=void 0!==$&&$,G=Object(a.a)(e,["alignContent","alignItems","classes","className","component","container","direction","item","justify","justifyContent","lg","md","sm","spacing","wrap","xl","xs","zeroMinWidth"]),D=Object(o.a)(u.root,d,g&&[u.container,0!==E&&u["spacing-xs-".concat(String(E))]],v&&u.item,B&&u.zeroMinWidth,"row"!==x&&u["direction-xs-".concat(String(x))],"wrap"!==I&&u["wrap-xs-".concat(String(I))],"stretch"!==l&&u["align-items-xs-".concat(String(l))],"stretch"!==i&&u["align-content-xs-".concat(String(i))],"flex-start"!==(y||S)&&u["justify-content-xs-".concat(String(y||S))],!1!==U&&u["grid-xs-".concat(String(U))],!1!==M&&u["grid-sm-".concat(String(M))],!1!==j&&u["grid-md-".concat(String(j))],!1!==_&&u["grid-lg-".concat(String(_))],!1!==F&&u["grid-xl-".concat(String(F))]);return s.createElement(h,Object(r.a)({className:D,ref:t},G))})),p=Object(i.a)((function(e){return Object(r.a)({root:{},container:{boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%"},item:{boxSizing:"border-box",margin:"0"},zeroMinWidth:{minWidth:0},"direction-xs-column":{flexDirection:"column"},"direction-xs-column-reverse":{flexDirection:"column-reverse"},"direction-xs-row-reverse":{flexDirection:"row-reverse"},"wrap-xs-nowrap":{flexWrap:"nowrap"},"wrap-xs-wrap-reverse":{flexWrap:"wrap-reverse"},"align-items-xs-center":{alignItems:"center"},"align-items-xs-flex-start":{alignItems:"flex-start"},"align-items-xs-flex-end":{alignItems:"flex-end"},"align-items-xs-baseline":{alignItems:"baseline"},"align-content-xs-center":{alignContent:"center"},"align-content-xs-flex-start":{alignContent:"flex-start"},"align-content-xs-flex-end":{alignContent:"flex-end"},"align-content-xs-space-between":{alignContent:"space-between"},"align-content-xs-space-around":{alignContent:"space-around"},"justify-content-xs-center":{justifyContent:"center"},"justify-content-xs-flex-end":{justifyContent:"flex-end"},"justify-content-xs-space-between":{justifyContent:"space-between"},"justify-content-xs-space-around":{justifyContent:"space-around"},"justify-content-xs-space-evenly":{justifyContent:"space-evenly"}},function(e,t){var n={};return c.forEach((function(a){var r=e.spacing(a);0!==r&&(n["spacing-".concat(t,"-").concat(a)]={margin:"-".concat(u(r,2)),width:"calc(100% + ".concat(u(r),")"),"& > $item":{padding:u(r,2)}})})),n}(e,"xs"),e.breakpoints.keys.reduce((function(t,n){return function(e,t,n){var a={};l.forEach((function(e){var t="grid-".concat(n,"-").concat(e);if(!0!==e)if("auto"!==e){var r="".concat(Math.round(e/12*1e8)/1e6,"%");a[t]={flexBasis:r,flexGrow:0,maxWidth:r}}else a[t]={flexBasis:"auto",flexGrow:0,maxWidth:"none"};else a[t]={flexBasis:0,flexGrow:1,maxWidth:"100%"}})),"xs"===n?Object(r.a)(e,a):e[t.breakpoints.up(n)]=a}(t,e,n),t}),{}))}),{name:"MuiGrid"})(d);t.a=p},504:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(12),r=n(1),s=n(1701),o=n(1702);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(s.a)(),i=Object(o.a)({theme:n,name:"MuiUseMediaQuery",props:{}});var c="function"==typeof e?e(n):e;c=c.replace(/^@media( ?)/m,"");var l="undefined"!=typeof window&&void 0!==window.matchMedia,u=Object(a.a)({},i,t),d=u.defaultMatches,p=void 0!==d&&d,h=u.matchMedia,f=void 0===h?l?window.matchMedia:null:h,g=u.noSsr,m=void 0!==g&&g,x=u.ssrMatchMedia,w=void 0===x?null:x,v=r.useState((function(){return m&&l?f(c).matches:w?w(c).matches:p})),y=v[0],b=v[1];return r.useEffect((function(){var e=!0;if(l){var t=f(c),n=function(){e&&b(t.matches)};return n(),t.addListener(n),function(){e=!1,t.removeListener(n)}}}),[c,f,l]),y}}}]);