(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{438:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isAsyncIterable=e.isAsyncGenerator=e.isAsync=void 0;var i,s=a(631),n=(i=s)&&i.__esModule?i:{default:i};function o(t){return"AsyncFunction"===t[Symbol.toStringTag]}e.default=function(t){if("function"!=typeof t)throw new Error("expected a function");return o(t)?(0,n.default)(t):t},e.isAsync=o,e.isAsyncGenerator=function(t){return"AsyncGenerator"===t[Symbol.toStringTag]},e.isAsyncIterable=function(t){return"function"==typeof t[Symbol.asyncIterator]}},447:function(t,e){var a,i,s=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(a===setTimeout)return setTimeout(t,0);if((a===n||!a)&&setTimeout)return a=setTimeout,setTimeout(t,0);try{return a(t,0)}catch(e){try{return a.call(null,t,0)}catch(e){return a.call(this,t,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:n}catch(t){a=n}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var l,c=[],d=!1,h=-1;function p(){d&&l&&(d=!1,l.length?c=l.concat(c):h=-1,c.length&&u())}function u(){if(!d){var t=r(p);d=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,d=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function f(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)e[a-1]=arguments[a];c.push(new m(t,e)),1!==c.length||d||r(u)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},467:function(t,e,a){var i=a(446),s=a(394),n=a(429);t.exports=function(t){return"string"==typeof t||!s(t)&&n(t)&&"[object String]"==i(t)}},472:function(t,e,a){var i=a(446),s=a(429);t.exports=function(t){return"number"==typeof t||s(t)&&"[object Number]"==i(t)}},486:function(t,e,a){"use strict";var i=a(1),s=a(383);e.a=Object(s.a)(i.createElement("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},487:function(t,e,a){"use strict";var i=a(1),s=a(383);e.a=Object(s.a)(i.createElement("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},488:function(t,e,a){"use strict";a.r(e),function(t){var i=a(1),s=a.n(i),n=a(502),o=a(623),r=a(740),l=a(881),c=a(743),d=a(880),h=a(741),p=a(818),u=a(742),m=a(671),f=a(672),g=a(738),y=a(1710),b=a(734),x=a(873),_=a(877),v=a(538),w=a.n(v),E=a(1709),I=a(562),k=a.n(I),C=a(557),S=a.n(C),P=a(592),O=a.n(P),L=a(507),D=a.n(L),j=a(563),R=a.n(j),T=a(636),A=a.n(T),F=a(639),M=a.n(F),B=a(559),z=a.n(B),H=a(637),N=a.n(H),q=a(670),V=a(638),G=a.n(V),W=a(583),$=a.n(W),U=a(517),K=a.n(U),Y=a(735),X=a(1703),J=a(669),Q=a(480),Z=a(461),tt=a(543),et=a.n(tt),at=a(1009),it=a(391),st=a.n(it),nt=a(418),ot=a.n(nt),rt=a(467),lt=a.n(rt),ct=a(427),dt=a.n(ct),ht=a(394),pt=a.n(ht),ut=a(374),mt=a(648),ft=a(646),gt=a(522),yt=a(544),bt=a(624),xt=a(503),_t=a(401),vt=a.n(_t),wt=a(386),Et=a.n(wt),It=a(55),kt=a.n(It),Ct=a(625),St=a.n(Ct);function Pt(){return(Pt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t}).apply(this,arguments)}const Ot={ADD:"add",EDIT:"edit",DELETE:"delete"};class Lt extends s.a.Component{constructor(t){super(t),this.handleChangePage=this.handleChangePage.bind(this),this.handleChangeRowsPerPage=this.handleChangeRowsPerPage.bind(this),this.handleItemUpdateEvent=this.handleItemUpdateEvent.bind(this),this.handleItemNewEvent=this.handleItemNewEvent.bind(this),this.handleItemDeleteEvent=this.handleItemDeleteEvent.bind(this),this.defaultRowView=this.defaultRowView.bind(this),this.defaultCardView=this.defaultCardView.bind(this),this.reRender=this.reRender.bind(this),this.refresh=this.refresh.bind(this),this.initForm=this.initForm.bind(this),this.selectAll=this.selectAll.bind(this),this.renderAddButton=this.renderAddButton.bind(this),this.renderPages=this.renderPages.bind(this),this.saveItem=this.saveItem.bind(this),this.EmitEvents=ot()(_t.EmitEvents),this.EmitEvents.events={};let e=[20,50,100,200,500,1e3,5e3,1e4,1e5],a=this.props.rowsPerPage||20;e.indexOf(a)<0&&(e.push(a),e=e.sort((t,e)=>t-e));const i=this.props.rows||[];(this.props.listInfo||{}).api_code||this.props.code||i.forEach((t,e)=>{t.line||(t.line=(new Date).getTime()+1e3*e)}),this.state={load:0,rowsPerPage:a,totalRows:0,page:0,selAll:!1,range_page:e,rows:i,typeDisplay:this.props.typeDisplay||(this.props.mediaQueryMatches?"GridView":"ListView")},this.validationConstraints=this.props.validationConstraints,(this.props.readOnly||this.props.disabled)&&(this.props.hideItemActions=!0),this.width_toolbar_row=130,!this.props.hideItemActions||this.props.itemActions||this.props.hideHeader?this.props.hideItemActions||this.props.hideHeader||!this.props.hideHeader||(this.width_toolbar_row=110):this.width_toolbar_row=25,this.handleCellClicked=this.props.handleCellClicked,this.handleCellClicked&&(this.handleCellClicked=this.handleCellClicked.bind(this))}async componentDidMount(){this.mounted=!0,this.loadListInfo(async()=>{this.api_code=(this.state.listInfo||{}).api_code||this.props.code,this.props.onlyImportData?this.context.setProgressStatus(!1):(!this.state.listInfo||!this.state.listInfo.search_required||this.props.hideHeader||this.props.noRender||this.props.defaultCondition&&0!==Object.keys(this.props.defaultCondition).length?this.countData():this.openSearch(),this.api_code&&(_t.EmitEvents.subscribe(this.api_code+":update",this.handleItemUpdateEvent),_t.EmitEvents.subscribe(this.api_code+":new",this.handleItemNewEvent),_t.EmitEvents.subscribe(this.api_code+":delete",this.handleItemDeleteEvent)))})}shouldComponentUpdate(t,e){return this.requireReloadListInfo=!1,e.load!==this.state.load||(t.readOnly!==this.props.readOnly?(this.requireReloadListInfo=!0,!0):st()(t.rows,this.props.rows)?t.code!==this.props.code?(this.requireReloadListInfo=!0,this.state.listInfo=null,!0):st()(t.listInfo,this.props.listInfo)&&st()(t.code,this.props.code)?!st()(t.defaultCondition,this.props.defaultCondition)&&(this.requireReloadListInfo=!0,!0):(this.requireReloadListInfo=!0,!0):(this.state.rows=t.rows,!0))}reRender(){this.setState({load:this.state.load+1})}async componentDidUpdate(){this.requireReloadListInfo&&(this.requireReloadListInfo=!1,this.loadListInfo(()=>{this.api_code=(this.state.listInfo||{}).api_code||this.props.code,this.props.onlyImportData?this.context.setProgressStatus(!1):!this.state.listInfo||!this.state.listInfo.search_required||this.props.hideHeader||this.props.noRender||this.props.defaultCondition&&0!==Object.keys(this.props.defaultCondition).length?this.countData():this.openSearch()}))}componentWillUnmount(){this.mounted=!1,this.api_code&&(_t.EmitEvents.unsubscribe(this.api_code+":update",this.handleItemUpdateEvent),_t.EmitEvents.unsubscribe(this.api_code+":new",this.handleItemNewEvent),_t.EmitEvents.unsubscribe(this.api_code+":delete",this.handleItemDeleteEvent))}addRow(t){let{rows:e}=this.state;e.push(t),this.setState({rows:e,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(e)})}isHidden(t,e,a,i="not_display"){if(!t[i])return!1;let s=t[i].toString();if("true"===s.toLowerCase())return!0;if("false"===s.toLowerCase())return!1;try{s=(s.indexOf("return ")<0?"return ":"")+s;return new Function("master","detail","context",s)(e||a,a,this.context)}catch(t){return console.error(t,s),!1}}check(t,e){t.sel=e;let a=this.state.rows.find(e=>e._id===t._id);a&&(a.sel=e),this.setState({rows:this.state.rows,load:this.state.load+1})}async handleItemUpdateEvent(t){let e;if(t.is_full_data)e=t;else if(e=await this.context.apis.asyncGetData(this.context.userInfo.token,this.api_code,{_id:t._id}),!e)return;const a=(this.state.rows||[]).map(t=>t._id===e._id?{...e}:t);this.setState({rows:a,load:this.state.load+1})}async handleItemNewEvent(t){const e=await this.context.apis.asyncGetData(this.context.userInfo.token,this.api_code,{_id:t._id});if(!e)return;const a=this.state.rows||[];a.push(e),this.setState({rows:a,load:this.state.load+1})}handleItemDeleteEvent(t){const e=(this.state.rows||[]).filter(e=>e._id!==t._id);this.setState({rows:e,load:this.state.load+1})}async loadListInfo(t){this.context.setProgressStatus(!0,null,"Loading list info....");let e=this.props.listInfo;if(this.columns=null,!e&&this.props.code)try{e=await this.context.apis.asyncGetData(this.context.userInfo?this.context.userInfo.token:this.context.config.public_token,"listinfo",{code:this.props.code.toLowerCase()},null,!0,!0)}catch(t){return console.error(t.message),this.context.setProgressStatus(!1),void(this.props.history&&this.props.history.replace("/404"))}if(!e&&this.props.formCode)try{e=await this.context.apis.asyncGetData(this.context.userInfo?this.context.userInfo.token:this.context.config.public_token,"listinfo",{code:this.props.formCode.toLowerCase()},null,!0,!0)}catch(t){return console.error(t.message),this.context.setProgressStatus(!1),void(this.props.history&&this.props.history.replace("/404"))}if(e){if(e.show_view_tabs_on_grid||e.get_other_fields){let t=(e.get_other_fields||"").split(","),a=(e.fields||[]).filter(t=>"Link"!==t.type&&"Action"!==t.type&&"Group"!==t.type&&!this.isHidden(t,this.props.master,{})).map(t=>t.name).concat(t);t=[...new Set(a.filter(t=>t))],t.length>0&&(this.fields=t.join(","))}try{if(this.context.appInfo){this.context.setProgressStatus(!0,null,"Get options....");let t=await this.context.apis.asyncGetData(this.context.userInfo.token,"options",{id_func:e.code},"option",!0,!0)||{};t&&(e.custom_fields=t.custom_fields,delete t.custom_fields,delete t.users_receive_notification,this.optionsData=t)}}catch(t){console.error(t)}if(this.props.validationConstraints||(this.validationConstraints=Object(gt.a)(e.fields,this.context),e.custom_fields&&(this.custom_validationConstraints=Object(gt.a)(e.custom_fields,this.context))),e.fields.filter(t=>"Array"===t.type&&!!t.form).forEach(t=>{this.context.apis.asyncGetData(this.context.userInfo?this.context.userInfo.token:this.context.config.public_token,"listinfo",{code:t.form.toLowerCase()},null,!0)}),!this.handleCellClicked&&e.handle_cell_clicked){let t=this.props.match&&this.props.match.params.module?this.props.match.params.module:"any";const a=new Function("row","column","module",e.handle_cell_clicked).bind(this);this.handleCellClicked=(e,i)=>{a(e,i,t)},this.handleCellClicked=this.handleCellClicked.bind(this)}}this.setState({listInfo:e,rows:this.props.rows||[],page:0,totalRows:0,load:this.state.load+1},()=>{this.EmitEvents.dispatch("listInfoLoead",e),this.context.setProgressStatus(!1),t&&t()})}async loadData(t){const e=this.api_code;if(!e)return this.context.setProgressStatus(!1);if(this.context.setProgressStatus(!0,null,"Loading data..."),t)t={...t,...this.props.requiredCondition,...this.props.dataRequired},this.condition=t;else if(this.condition)t={...this.condition,...this.props.requiredCondition,...this.props.dataRequired};else{let e=await this.getDefaultConditon();t={...this.props.requiredCondition,...this.props.dataRequired,...e},this.props.isDrilldown=!1}try{let a={condition:t,page:this.state.page+1,limit:this.state.rowsPerPage,fields:this.fields},i=await this.context.apis.asyncGetList(this.context.userInfo?this.context.userInfo.token:this.context.config.public_token,e,a);this.props.onLoadData&&this.props.onLoadData(i,a);let s=null;i.length>0&&(s=i[0]),this.setState({rows:i,rowSelected:s,load:this.state.load+1}),this.context.setProgressStatus(!1)}catch(t){this.context.alert(t.message||t)}}async getDefaultConditon(){let t={};if(this.state.listInfo){if(this.props.defaultCondition){let e=this.state.listInfo.fields;for(let a in this.props.defaultCondition){let i=e.find(t=>t.name===a);("_id"===a||"$or"===a||"$and"===a||i&&!i.is_tmp)&&(t[a]=this.props.defaultCondition[a])}"$or"==this.props.defaultCondition.cType&&Object.keys(t).length>0&&(t={$or:Object.keys(t).map(e=>({[e]:t[e]}))})}if(this.state.listInfo.default_condition){let e=this.state.listInfo.default_condition;e.indexOf("return")<0&&(e="return "+e),e=`return (async ()=>{\n          ${e}\n        })()`;const a=new Function("Moment","API","utils","context",e);try{let e=await a(Et.a,this.context.apis,vt.a,this.context);for(let a in e)("_id"===a||this.state.listInfo.fields.find(t=>t.name===a))&&(t[a]=e[a])}catch(t){console.error(t.message)}}}return t}async countData(t){let e=this.api_code;if(!e||this.props.noRender)return this.setState({load:this.state.load+1}),this.context.setProgressStatus(!1);if(this.context.setProgressStatus(!0),t)t={...t,...this.props.requiredCondition,...this.props.dataRequired},this.condition=t;else if(this.condition)t={...this.condition,...this.props.requiredCondition,...this.props.dataRequired};else{let e=await this.getDefaultConditon();t={...e,...this.props.requiredCondition,...this.props.dataRequired},this.props.isDrilldown=!1}const a=this;St()({count:t=>{a.loadData().then(()=>{t()}).catch(e=>{t(e.message)})},data:i=>{a.context.apis.asyncGetList(a.context.userInfo?a.context.userInfo.token:a.context.config.public_token,e,{condition:t,count:!0}).then(t=>{this.setState({totalRows:t.rows_number,rowSelected:null,page:0},async()=>{i()})}).catch(t=>{i(t.message)})}},e=>{e&&((e.message||"").toLowerCase().indexOf("token")>=0?(this.context.setProgressStatus(!1),this.context.signin(()=>{this.countData(t)})):this.context.alert(e.message||e))})}async getSearchFields(){let t,{listInfo:e}=this.state;return e&&(e.search_form&&(this.searchFormInfo||(this.searchFormInfo=await this.context.apis.asyncGetData(this.context.userInfo.token,"listinfo",{code:e.search_form.toLowerCase()},null,!0)),this.searchFormInfo&&(t=this.searchFormInfo.fields)),t||(t=ot()(e.fields||[]).filter(t=>("String"===t.type||"Date"===t.type)&&!t.not_display&&"textarea"!==t.html_component_input&&"editor"!==t.html_component_input).map(t=>(delete t.required,t)))),t}refresh(){this.countData()}async openSearch(){this.tourGuide&&this.tourGuide.close(),this.props.code&&(this.props.searchForm||this.state.listInfo)&&(await new Promise(t=>{(async()=>{if(this._searchForm)t();else{let e,i,{listInfo:n}=this.state;!this.props.searchForm&&n&&(e=await this.getSearchFields(),i={},await Object(yt.a)(i,e,this.context,this.props.master,this.context.userInfo.token),i={...i,...this.props.defaultCondition},delete i._id);const{default:o}=await a.e(50).then(a.bind(null,641));this.setState({load:this.state.load+1,SearchFormComponent:s.a.createElement(o,{ref:t=>this._searchForm=t,form:this.props.searchForm,fields:e,disableBackdropClick:(this.state.listInfo||{}).search_required,disableEscapeKeyDown:(this.state.listInfo||{}).search_required,defaultCondition:i,onSearch:this.search.bind(this)})},()=>{t()})}})()}),this.context.setProgressStatus(!1),this._searchForm.open())}async search(t,e={},a=[]){if(!this.api_code)return;let i={...e};if(lt()(t)){let e=await Object(_t.unicode2Ascii)(t);i.$text={$search:t+" "+e}}else{a.filter(t=>t.ref_label).forEach(e=>{delete t[e.ref_label],e.ref_label_as&&delete t[e.ref_label_as]});for(let e in t){let s=t[e];if(!i[e]&&void 0!==s)if("_id"===e)i[e]=s;else{let t=a.find(t=>t.name===e);t&&t.setCondition?t.setCondition(i,s):"string"==typeof s&&"_id"!==e&&(i[e]={$regex:s,$options:"i"})}}}this.setState({page:0},()=>{this.countData(i)})}handleChangePage(t,e){this.setState({page:e,load:this.state.load+1},async()=>{await this.loadData()})}handleChangeRowsPerPage(t){this.setState({page:0,rowsPerPage:+t.target.value,load:this.state.load+1},async()=>{await this.loadData()})}handleValueChanged(t){let e=this.state.current;for(let a in t)e[a]=t[a];this.setState({current:e,load:this.state.load+1})}applyChanged(){this.setState({rows:this.state.rows,load:this.state.load+1})}hasRight(t,e){return!!this.context.userInfo&&((!this.state.listInfo||e!==Ot.DELETE||1!=this.state.listInfo.not_delete)&&((!this.state.listInfo||e!==Ot.EDIT||1!=this.state.listInfo.not_edit)&&(!this.props.hasRight||this.props.hasRight(this.context.userInfo,t,e))))}async waitLoadListInfo(){this.state.listInfo||!this.props.code||this.props.form||await new Promise(t=>{let e="listInfoLoead",a=this.EmitEvents.subscribe(e,()=>{t(),this.EmitEvents.unsubscribe(e,a)})})}async addItem(){await this.waitLoadListInfo(),this.tourGuide&&this.tourGuide.close(),this.quickAddCallback=null,this.quickAddOptions=null,this.deleteCallback=null,this.quickEditCallback=null,this.old_data=null,this.context.signin(async t=>{if(this.hasRight({},Ot.ADD)){let e=this.props.defaultData;if(e&&"function"==typeof e&&(e=e(this)),e||(e={}),delete e._id,this.state.listInfo&&(await Object(yt.a)(e,this.state.listInfo.fields,this.context,this.props.master,t.token),this.state.listInfo.custom_fields&&(e.exfields||(e.exfields={}),await Object(yt.a)(e.exfields,this.state.listInfo.custom_fields,this.context,this.props.master,t.token))),!this.optionsData&&this.props.code&&this.context.appInfo){let t=this.props.code.toLowerCase();try{this.optionsData=await this.context.apis.asyncGetData(this.context.userInfo.token,"options",{id_func:t},"option",!0)||{},delete this.optionsData.custom_fields,delete this.optionsData.users_receive_notification}catch(t){this.optionsData={},console.error(t.message)}}else this.optionsData={};e={...e,...this.optionsData};let a={...e};delete a._id;if(!await this.initForm(a))return;this.mainFormRef.open(a,this.props.master)}else this.context.alert(this.context.apis.getLabel("Bạn không có quyền thêm mới dữ liệu"))},{only_signin:"app"===this.props.code,allow_cancel:!0})}async quickAdd(t,e,a={addToRows:!0}){await this.waitLoadListInfo(),this.state.listInfo?(this.quickAddCallback=e,this.deleteCallback=null,this.quickEditCallback=null,this.old_data=null,this.quickAddOptions=a,this.context.signin(async e=>{if(this.hasRight({},Ot.ADD)){let a=this.props.defaultData;if(a=a&&"function"==typeof a?a(this):ot()(a),a||(a={}),delete a._id,this.state.listInfo&&(await Object(yt.a)(a,this.state.listInfo.fields,this.context,this.props.master,e.token),this.state.listInfo.custom_fields&&(a.exfields||(a.exfields={}),await Object(yt.a)(a.exfields,this.state.listInfo.custom_fields,this.context,this.props.master,e.token))),!this.optionsData&&this.props.code){let t=this.props.code.toLowerCase();try{this.optionsData=await this.context.apis.asyncGetData(this.context.userInfo.token,"options",{id_func:t},"option",!0)||{}}catch(t){this.optionsData={},console.error(t.message)}}a={...a,...this.optionsData},t&&(a={...a,...t});let i={...a};delete i._id;if(!await this.initForm(i))return;this.mainFormRef.open(i,this.props.master)}else this.context.alert(this.context.apis.getLabel("Bạn không có quyền thêm mới dữ liệu"))})):this.context.alert(this.context.apis.getLabel("Danh mục này chưa được khai báo."))}async copyItem(t){if(this.state.listInfo&&this.state.listInfo.not_add)return this.context.alert(this.context.apis.getLabel("Không thể sao chép dữ liệu này"));this.quickAddCallback=null,this.quickAddOptions=null,this.deleteCallback=null,this.old_data=null,await this.waitLoadListInfo(),this.context.signin(async e=>{if(this.hasRight({},Ot.ADD)){let a=ot()(t);delete a._id,delete a.line,delete a.so_ct,delete a.ngay_ct,delete a.user_created,delete a.name_user_created,delete a.date_created,delete a.user_updated,delete a.name_user_updated,delete a.date_updated,a.exfields&&a.exfields.__supports__&&delete a.exfields.__supports__,a.exfields&&a.exfields.__files__&&delete a.exfields.__files__;let i=this.props.defaultData;i=i&&"function"==typeof i?i(this):ot()(i),i||(i={}),this.state.listInfo&&(await Object(yt.a)(i,this.state.listInfo.fields,this.context,this.props.master,e.token,["[]"]),this.state.listInfo.custom_fields&&(i.exfields||(i.exfields={}),await Object(yt.a)(i.exfields,this.state.listInfo.custom_fields,this.context,this.props.master,e.token))),a={...a,so_ct:i.so_ct,ngay_ct:i.ngay_ct};if(!await this.initForm(a))return;this.mainFormRef.open(a,this.props.master,{title:this.context.apis.getLabel("Sao chép")})}else this.context.alert(this.context.apis.getLabel("Bạn không có quyền thêm mới dữ liệu"))})}async getItem(t){if(!t)return null;let e={_id:t};const a=this.api_code;if(!a)return null;this.context.setProgressStatus(!0,null,"Get data...");try{const t=this.context.apis.asyncGetData(this.context.userInfo.token,a,e);return this.context.setProgressStatus(!1),t}catch(e){if((e.message||"").toLowerCase().indexOf("token")>=0){return this.context.setProgressStatus(!1),await this.context.signin()?this.getItem(t):null}return this.context.alert(e.message||e),null}}editItem(t){this.quickAddCallback=null,this.quickAddOptions=null,this.deleteCallback=null,this.context.setProgressStatus(!0),this.context.signin(async()=>{if(this.hasRight(t,Ot.EDIT)){let e;if(this.context.setProgressStatus(!0),this.api_code&&t._id?t.is_full_data?(e=ot()(t),this.old_data=t):(e=await this.getItem(t._id),t.is_full_data=!0,this.old_data={...e}):e=ot()(t),this.context.setProgressStatus(!1),!e)return;this.mainFormRef.open(e,this.props.master)}else this.context.alert(this.context.apis.getLabel("Bạn không có quyền sửa đối tượng này"))})}async quickEdit(t,e,a){await this.waitLoadListInfo(),this.state.listInfo?(this.quickEditCallback=e,this.deleteCallback=a,this.quickAddCallback=null,this.context.setProgressStatus(!0),this.context.signin(async()=>{if(this.hasRight(t,Ot.EDIT)){let e;if(this.context.setProgressStatus(!0),this.api_code&&t._id?t.is_full_data?(e=ot()(t),this.old_data=t):(e=await this.getItem(t._id),t.is_full_data=!0,this.old_data={...e}):e=ot()(t),this.context.setProgressStatus(!1),!e)return;this.mainFormRef.open(e,this.props.master)}else this.context.alert(this.context.apis.getLabel("Bạn không có quyền sửa đối tượng này"))})):this.context.alert(this.context.apis.getLabel("Danh mục này chưa được khai báo."))}async initForm(t){if(this.state.listInfo&&this.state.listInfo.on_init)try{let e=this.state.listInfo.on_init;e=`return (async ()=>{\n          ${e}\n        })();`;const a=new Function("master","detail","API","context","utils",e);let i=await a(this.props.master||t,t,this.context.apis,this.context,vt.a);if(i&&i.error)return this.context.alert(i.error),!1}catch(t){return this.context.alert(t.message),!1}return!0}async saveItem(e){this.props.dataRequired&&(e=Object.assign(e,this.props.dataRequired));let a=this.validationConstraints||{},i=et()(e,a,{format:"flat"});if(i){let t=i.join("<br/>");return void this.context.alert(t)}if(this.custom_validationConstraints&&(i=et()(e.exfields||{},this.custom_validationConstraints,{format:"flat"}),i)){let t=i.join("<br/>");return void this.context.alert(t)}if(this.state.listInfo&&this.state.listInfo.expression_check_save)try{let t=this.state.listInfo.expression_check_save;t=`return (async ()=>{\n          ${t}\n        })();`;const a=new Function("master","detail","API","context","utils",t);let i=await a(this.props.master||e,e,this.context.apis,this.context,vt.a);if(i&&i.error)return this.context.alert(i.error)}catch(t){return this.context.alert(t.message)}let s=this.api_code;if(s){this.context.setProgressStatus(!0,null,"Save data...");let a=this.state.rows;try{let i;try{let a;if(this.old_data&&this.old_data._id&&e._id&&this.old_data._id===e._id){a=Object(_t.difference)(e,this.old_data),a._id=e._id;for(let t in e)a[t]&&(dt()(a[t])&&Object(a[t]).keys&&0==Object(a[t]).keys().length&&delete a[t],pt()(a[t])&&0===a[t].length&&e[t]&&0!==e[t].length&&delete a[t]),"approve_data"!==t&&a[t]&&(dt()(e[t])||pt()(e[t]))&&(a[t]=e[t])}else a=e;i=await this.context.apis.asyncPostList(this.context.userInfo.token,s,a),this.context.setProgressStatus(!1),i.is_full_data=!0,t(()=>{for(let t=0;t<localStorage.length;t++){let e=localStorage.key(t);e.indexOf(i._id)>=0&&localStorage.removeItem(e)}})}catch(t){console.error(t);let e=(t.message||t.error||t||"").toString();return void this.context.alert(e)}const n=(this.state.rows||[]).find(t=>t._id===i._id);if(n)for(let t in i)n[t]=i[t];else this.quickAddOptions&&!1===this.quickAddOptions.addToRows||(a=[i].concat(this.state.rows));if(this.mainFormRef.close(),this.context.setProgressStatus(!1),this.setState({rows:a,rowSelected:i,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)}),this.state.listInfo&&this.state.listInfo.on_saved)try{let t=this.state.listInfo.on_saved;t=`return (async ()=>{\n              ${t}\n            })();`;const a=new Function("master","detail","origin_data","API","context","utils",t);await a(this.props.master||i,i,e,this.context.apis,this.context,vt.a)}catch(t){console.error("error on saved:",t.message)}this.props.onSave&&this.props.onSave(i),this.quickAddCallback&&this.quickAddCallback(i),this.quickEditCallback&&this.quickEditCallback(i),this.quickAddOptions=null,this.quickAddCallback=null,this.quickEditCallback=null}catch(t){console.error(t),this.context.alert(t.message||t)}}else{if(!this.props.onSave){null!=e.line&&null!=e.line||(e.line=(new Date).getTime());const t=this.state.rows.find(t=>t.line===e.line);if(t)for(let a in e)t[a]=e[a];else this.state.rows.push(e);return this.mainFormRef.close(),void this.setState({rows:this.state.rows,rowSelected:e,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)})}this.props.onSave(e)}}async deleteItem(e,a){if(this.state.listInfo&&this.state.listInfo.not_delete)return this.context.alert(this.context.apis.getLabel("Không thể xoá dữ liệu này"));this.context.alert(this.context.apis.getLabel("Bạn có chắc chắn xoá không?"),async i=>{if(i){let i=this.api_code;if(i){this.context.setProgressStatus(!0);try{if(this.state.listInfo&&this.state.listInfo.on_deleting){let t=this.state.listInfo.on_deleting;t=`return (async ()=>{\n                ${t}\n              })();`;const a=new Function("master","detail","API","context","utils",t);let i=await a(this.props.master||e,e,this.context.apis,this.context,vt.a);if(i&&i.error)throw i.error}try{await this.context.apis.asyncDeleteList(this.context.userInfo.token,i,e._id),t(()=>{for(let t=0;t<localStorage.length;t++){let a=localStorage.key(t);a.indexOf(e._id)>=0&&localStorage.removeItem(a)}})}catch(t){let e=(t.message||t.error||t||"").toString();return void this.context.alert(e)}const s=this.state.rows.filter(t=>t._id!==e._id);if(this.context.setProgressStatus(!1),this.mainFormRef.close(),this.setState({rows:s,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)}),this.state.listInfo&&this.state.listInfo.on_deleted)try{let t=this.state.listInfo.on_deleted;t=`return (async ()=>{\n                  ${t}\n                })();`;const a=new Function("master","detail","API","context","utils",t);await a(this.props.master||e,e,this.context.apis,this.context,vt.a)}catch(t){console.error("error on deleted",t.message)}this.props.onDeleted&&this.props.onDeleted(e),a&&a(e),this.deleteCallback&&this.deleteCallback(e)}catch(t){console.error(t),this.context.alert(t.message||t)}}else if(this.props.onDelete)this.props.onDelete(e);else{const t=this.state.rows.filter(t=>t.line!==e.line);this.mainFormRef.close(),this.setState({rows:t,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)})}}},"black")}deleteItems(){this.tourGuide&&this.tourGuide.close(),this.state.rows.find(t=>t.sel)?this.context.alert(this.context.apis.getLabel("Bạn có chắc chắn xoá tất cả các dòng đã chọn không?"),async e=>{if(e){let e=this.api_code;if(e){this.context.setProgressStatus(!0);try{await Promise.all(this.state.rows.filter(t=>t.sel).map(async a=>{if(this.hasRight(a,Ot.DELETE)){if(this.state.listInfo&&this.state.listInfo.on_deleting){let t=this.state.listInfo.on_deleting;t=`return (async ()=>{\n                    ${t}\n                  })();`;const e=new Function("master","detail","API","context","utils",t);let i=await e(this.props.master||a,a,this.context.apis,this.context,vt.a);if(i&&i.error)throw i.error}if(await this.context.apis.asyncDeleteList(this.context.userInfo.token,e,a._id),t(()=>{for(let t=0;t<localStorage.length;t++){let e=localStorage.key(t);e.indexOf(a._id)>=0&&localStorage.removeItem(e)}}),this.state.listInfo&&this.state.listInfo.on_deleted)try{let t=this.state.listInfo.on_deleted;t=`return (async ()=>{\n                      ${t}\n                    })();`;const e=new Function("master","detail","API","context","utils",t);await e(this.props.master||a,a,this.context.apis,this.context,vt.a)}catch(t){console.error("error on deleted",t.message)}this.props.onDeleted&&this.props.onDeleted(a)}}));const a=this.state.rows.filter(t=>!t.sel||!this.hasRight(t,Ot.DELETE));this.context.setProgressStatus(!1),this.mainFormRef.close(),this.setState({rows:a,selAll:!1,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)})}catch(t){this.context.setProgressStatus(!1),this.context.alert(t.message||t)}}else{const t=this.state.rows.filter(t=>!t.sel||!this.hasRight(t,Ot.DELETE));this.mainFormRef.close(),this.setState({rows:t,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)})}}}):this.context.alert(this.context.apis.getLabel("Bạn phải chọn ít nhất một dòng để xoá"))}export2excel(){this.menuImpExp&&this.menuImpExp.handleClose();let t=this,e=this.api_code;this.context.objectPicker("exportexceltemplate","Chọn một mẫu excel",{callback:a=>{let i;i=this.context.apis.list_not_require_id_app.indexOf(e)>=0?this.context.config.server_url_report+"/api/"+e+"?type_data=xlsx&limit=1000000000&access_token="+this.context.userInfo.token:this.context.config.server_url_report+"/api/"+this.context.config.id_app+"/"+e+"?type_data=xlsx&limit=1000000000&access_token="+this.context.userInfo.token,this.condition&&(i=`${i}&q=${JSON.stringify(this.condition)}`),i=`${i}&id_template=${a._id}`,this.context.apis.downloadFile(i,e+".xlsx",(function(e){e&&t.context.alert(this.context.apis.getLabel("Không thể xuất excel. File mẫu không tồn tại"))}))},condition:{id_company:{$in:[null,void 0,"",this.context.config.id_app]},code:t.props.code},props:{formSize:"sm",hideTableHeader:!1,hideHeader:!0,showPages:!1,defaultData:{id_company:this.context.config.id_app}}})}export2json(){this.menuImpExp&&this.menuImpExp.handleClose();let t,e=this,a=this.api_code;t=this.context.apis.list_not_require_id_app.indexOf(a)>=0?this.context.config.server_url_report+"/api/"+a+"?limit=1000000000&access_token="+this.context.userInfo.token:this.context.config.server_url_report+"/api/"+this.context.config.id_app+"/"+a+"?limit=1000000000&access_token="+this.context.userInfo.token,this.condition&&(t=`${t}&q=${JSON.stringify(this.condition)}`),this.context.apis.downloadFile(t,a+".json",(function(t){t&&e.context.alert(this.context.apis.getLabel("Không thể xuất excel. File mẫu không tồn tại"))}))}selColumn(t,e){t.sel=e.target.checked}selectAll(){let t=!this.state.selAll;const{rows:e}=this.state;e.forEach(e=>{e.sel=t}),this.setState({rows:e,selAll:t,load:this.state.load+1},()=>{this.props.onRowsChanged&&this.props.onRowsChanged(this.state.rows)})}async checkDuplicate(){this.menuother&&this.menuother.close();let t=this.columns.filter(t=>t.sel);if(0===t.length)return this.context.alert(this.context.apis.getLabel("Phải chọn ít nhất một cột để kiểm tra"));this.menuCheck&&this.menuCheck.handleClose();let e=this.api_code;try{this.context.setProgressStatus(!0);let a=(await this.context.apis.asyncGetList(this.context.userInfo.token,e,{limit:1e13,buildUrl:e=>{let a={_id:t.reduce((t,e)=>(t[e.name]="$"+e.name,t),{}),count:{$sum:1},ids:{$push:"$_id"}};return e=`${e=`${e}&group=${JSON.stringify(a)}`}&match=${JSON.stringify({count:{$gt:1}})}`}})).map(t=>t.ids).reduce((t,e)=>t.concat(e),[]);this.search({_id:{$in:a}})}catch(t){console.error(t),this.context.alert(this.context.apis.getLabel(t.message||t.error||t))}}importfromexcel(t){this.menuImpExp&&this.menuImpExp.handleClose();let e,a=this.api_code;e=this.context.apis.list_not_require_id_app.indexOf(a)>=0?this.context.config.server_url_report+"/api/"+a+"/import/excel?update=true&access_token="+this.context.userInfo.token:this.context.config.server_url_report+"/api/"+this.context.config.id_app+"/"+a+"/import/excel?update=true&access_token="+this.context.userInfo.token,this.context.setProgressStatus(!0),this.context.apis.uploadFile(e,t,t=>{if(t)return console.error(t),this.context.alert(t.message||this.context.apis.getLabel("Đã có lỗi khi import dữ liệu."));this.context.alert(this.context.apis.getLabel("Chương trình đã thực hiện xong"),null,"green"),this.props.onlyImportData||this.countData()},{name:"xlsx"})}importfromjson(t){this.menuImpExp&&this.menuImpExp.handleClose();let e,a=this.api_code;e=this.context.apis.list_not_require_id_app.indexOf(a)>=0?this.context.config.server_url_report+"/api/"+a+"/import/json?update=true&access_token="+this.context.userInfo.token:this.context.config.server_url_report+"/api/"+this.context.config.id_app+"/"+a+"/import/json?update=true&access_token="+this.context.userInfo.token,this.context.setProgressStatus(!0),this.context.apis.uploadFile(e,t,t=>{if(t)return console.error(t),this.context.alert(t.message||this.context.apis.getLabel("Đã có lỗi khi import dữ liệu"));this.context.alert(this.context.apis.getLabel("Chương trình đã thực hiện xong"),null,"green"),this.props.onlyImportData||this.countData()},{name:"json"})}async printItems(){this.tourGuide&&this.tourGuide.close(),await new Promise(t=>{(async()=>{if(this.printDialogRef)t();else{const{default:e}=await a.e(52).then(a.bind(null,642));this.setState({load:this.state.load+1,PrintDialog:s.a.createElement(e,{code:this.state.listInfo.code,ref:t=>this.printDialogRef=t})},()=>{t()})}})()});const t=this,e=this.api_code;this.printDialogRef.open((a,i)=>{let s=this.state.rows.filter(t=>t.sel);if(0===s.length)return this.context.alert(this.context.apis.getLabel("Bạn phải chọn ít nhất một dòng để in"));let n=this.context.config.server_url_report+"/api/"+this.context.config.id_app+"/"+e+"/excel/"+a._id+"?_id="+s.map(t=>t._id).join(",")+"&access_token="+this.context.userInfo.token;"print"===i.name?(n+="&print=1",this.printLocal(n)):this.context.apis.downloadFile(n,(a.file||{}).name||a.ten_mau_in+".xlsx",(function(e){e&&t.context.alert(e)}))})}async printLocal(t,e=(()=>{})){let a;this.context.setProgressStatus(!0);try{a=await this.context.apis.asyncGet(t),this.context.setProgressStatus(!1)}catch(t){return this.context.alert(t.message)}this.setState({printFrame:null,load:this.state.load+1},()=>{let t=s.a.createElement("iframe",{onLoad:()=>{let t=window.frames.printframe;t.focus(),t.print(),e()},name:"printframe",style:{display:"none",width:"100%",height:"100%"},srcDoc:a});this.setState({printFrame:t,load:this.state.load+1})})}async options(){this.tourGuide&&this.tourGuide.close(),this.menuother&&this.menuother.close(),await new Promise(t=>{(async()=>{if(this.optionsFormRef)t();else{const{default:e}=await a.e(51).then(a.bind(null,811));this.setState({load:this.state.load+1,OptionsForm:s.a.createElement(e,{optionsDataCode:this.state.listInfo.code,optionsFormCode:this.props.optionsFormCode,defaultOptionsCode:this.props.defaultOptionsCode,ref:t=>this.optionsFormRef=t})},()=>{t()})}})()});const t=this;this.optionsFormRef&&this.optionsFormRef.open(e=>{t.optionsData=ot()(e)})}async tour(){this.menuother&&this.menuother.close(),await new Promise(t=>{(async()=>{if(this.tourGuide)t();else{const{default:e}=await a.e(30).then(a.bind(null,813));this.setState({load:this.state.load+1,TourGuide:s.a.createElement(e,{ref:t=>this.tourGuide=t})},()=>{t()})}})()});const t=[{selector:'[datatour="add"]',content:()=>s.a.createElement("div",{style:{marginTop:20}},this.context.apis.getLabel("Click vào đây để thêm mới dữ liệu"))},{selector:'[datatour="filter"]',content:()=>s.a.createElement("div",{style:{marginTop:20}},this.context.apis.getLabel("Tìm dữ liệu đã nhập"))}];this.state.listInfo&&this.props.print&&t.push({selector:'[datatour="print"]',content:()=>s.a.createElement("div",{style:{marginTop:20}},this.context.apis.getLabel("Chọn một hoặc nhiều dòng rồi xuất excel để in theo mẫu có sẵn hoặc tự thiết kế"))}),this.state.listInfo&&t.push({selector:'[datatour="delete"]',content:()=>s.a.createElement("div",{style:{marginTop:20}},this.context.apis.getLabel("Chọn một hoặc nhiều dòng để xoá"))}),this.state.listInfo&&t.push({selector:'[datatour="impexp"]',content:()=>s.a.createElement("div",{style:{marginTop:20}},this.context.apis.getLabel("Nhập xuất dữ liệu"))}),this.tourGuide.open(t)}defaultRowView(t,e,a){return s.a.createElement(u.a,{hover:!0},"right"!==this.props.rowToolbarALign&&(0!=this.props.multiSel&&!this.props.hideHeader||!this.props.hideItemActions||this.props.itemActions)&&s.a.createElement(c.a,{align:"center",width:this.width_toolbar_row,style:{...a,minWidth:this.width_toolbar_row}},!this.props.hideHeader&&0!=this.props.multiSel&&s.a.createElement(Z.a,{size:"small",value:t.sel,color:"primary",checked:t.sel,onChange:()=>this.check(t,!t.sel)}),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.EDIT)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sửa")},s.a.createElement(J.a,{size:"small",color:"primary",onClick:()=>this.editItem(t)},s.a.createElement(D.a,null))),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.DELETE)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Xoá")},s.a.createElement(J.a,{size:"small",color:"primary",onClick:()=>this.deleteItem(t)},s.a.createElement(R.a,null))),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.ADD)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sao chép")},s.a.createElement(J.a,{size:"small",color:"primary",onClick:()=>this.copyItem(t)},s.a.createElement(A.a,null))),!!this.props.itemActions&&this.props.itemActions(t,this)),e.map(e=>{let i=t[e.id]||t[e.name||e.id];return s.a.createElement(c.a,{key:e.id,align:e.align,style:{...a,cursor:"pointer",minWidth:e.minWidth,maxWidth:e.maxWidth||240},onClick:()=>{if(("Link"!==e.type&&"Action"!==e.type||!e.default)&&"File"!==e.type&&"OtherFile"!==e.type&&"Pdf"!==e.type){if(this.handleCellClicked)return this.handleCellClicked(t,e);this.props.readOnly||this.editItem(t)}}},e.format?e.format(i,t,this,{whiteSpace:"nowrap"}):i)}),"right"===this.props.rowToolbarALign&&(0!=this.props.multiSel&&!this.props.hideHeader||!this.props.hideItemActions||this.props.itemActions)&&s.a.createElement(c.a,{align:"center",width:this.width_toolbar_row,style:{...a,minWidth:this.width_toolbar_row}},!this.props.hideHeader&&0!=this.props.multiSel&&s.a.createElement(Z.a,{size:"small",value:t.sel,color:"primary",checked:t.sel,onChange:()=>this.check(t,!t.sel)}),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.EDIT)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sửa")},s.a.createElement(J.a,{size:"small",color:"primary",onClick:()=>this.editItem(t)},s.a.createElement(D.a,null))),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.DELETE)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Xoá")},s.a.createElement(J.a,{size:"small",color:"primary",onClick:()=>this.deleteItem(t)},s.a.createElement(R.a,null))),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.ADD)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sao chép")},s.a.createElement(J.a,{size:"small",color:"primary",onClick:()=>this.copyItem(t)},s.a.createElement(A.a,null))),!!this.props.itemActions&&this.props.itemActions(t,this)))}defaultCardView(t,e){return s.a.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},s.a.createElement("div",{style:{flex:1,padding:10}},e.filter(t=>1==t.hideLabelWhenSmallScreen||t.is_title).map((e,a)=>{let i=t[e.id]||t[e.name||e.id];return s.a.createElement("div",{key:e.id,style:{padding:"10px 0 10px 0",borderTop:0===a?null:"1px dotted silver"},onClick:()=>{if("Action"!==e.type&&"Link"!==e.type&&e.default&&"File"!==e.type&&"OtherFile"!==e.type&&"Pdf"!==e.type)return this.handleCellClicked?this.handleCellClicked(t,e):void(this.props.readOnly||this.editItem(t))}},s.a.createElement("div",{style:{textAlign:e.hideLabelWhenSmallScreen?"left":"right"}},e.format?e.format(i,t,this):i))}),e.filter(t=>1!=t.hideLabelWhenSmallScreen&&!t.is_title).map((e,a)=>{const i=t[e.id]||t[e.name||e.id];return s.a.createElement(Q.a,{container:!0,spacing:0,direction:"row",justify:"space-between",alignItems:"center",key:e.id,style:{padding:"10px 0 10px 0",borderTop:0===a?null:"1px dotted silver"},onClick:()=>{if("Action"!==e.type&&"Link"!==e.type&&"File"!==e.type&&"OtherFile"!==e.type&&"Pdf"!==e.type)return this.handleCellClicked?this.handleCellClicked(t,e):void(this.props.readOnly||this.editItem(t))}},s.a.createElement(Q.a,{item:!0,xs:4,sm:4,md:4},s.a.createElement(E.a,{variant:"caption"},e.label)),s.a.createElement(Q.a,{item:!0,xs:8,sm:8,md:8,style:{textAlign:e.hideLabelWhenSmallScreen?"left":"right"}},e.format?e.format(i,t,this):i))})),(!this.props.hideItemActions||!1!==this.props.multiSel||this.props.itemActions)&&s.a.createElement("div",{style:{padding:10}},!!this.props.itemActions&&this.props.itemActions(t,this),!this.props.itemActions&&s.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},!1!==this.props.multiSel&&!this.props.hideHeader&&s.a.createElement(Z.a,{value:t.sel,color:"primary",checked:t.sel,onChange:()=>this.check(t,!t.sel)}),!this.props.itemActions&&this.hasRight(t,Ot.EDIT)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sửa")},s.a.createElement(J.a,{color:"primary",onClick:()=>this.editItem(t)},s.a.createElement(D.a,null))),!this.props.itemActions&&this.hasRight(t,Ot.DELETE)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Xoá")},s.a.createElement(J.a,{color:"primary",onClick:()=>this.deleteItem(t)},s.a.createElement(R.a,null))),!this.props.itemActions&&this.hasRight(t,Ot.Add)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sao chép")},s.a.createElement(J.a,{color:"primary",onClick:()=>this.copyItem(t)},s.a.createElement(A.a,null))))))}renderListTabs(t,e,a){if(!this.props.code||!this.state.listInfo)return null;if(a||(a=t.filter(t=>t.is_title)),0===a.length)return console.log("Để hiện được theo kiểu tabview phải chọn ít nhất một cột title"),null;let{rowSelected:i}=this.state;e.length>0&&!i&&(i=this.state.rowSelected=e[0]);let r=(this.props.hideHeader||this.props.mediaQueryMatches,"100%");return s.a.createElement("div",{style:{overflow:"hidden",height:r}},s.a.createElement(Q.a,{container:!0,spacing:1,style:{height:"100%"}},s.a.createElement(Q.a,{item:!0,xs:12,sm:12,md:3,lg:3,style:{height:"100%"}},s.a.createElement(m.a,{variant:"outlined",style:{display:"flex",flexDirection:"column",height:"100%"}},s.a.createElement(y.a,{style:{overflow:"auto",flex:1}},s.a.createElement(n.a,{key:"_id",items:e,renderItem:e=>s.a.createElement(b.a,{button:!0,selected:i&&i._id===e._id,style:{padding:0}},s.a.createElement(o.a,{row:e,COLUMNS:t,renderItem:t=>s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:5}},0!=this.props.multiSel&&!this.props.hideHeader&&s.a.createElement(Z.a,{size:"small",value:t.sel,color:"primary",checked:t.sel,onChange:()=>this.check(t,!t.sel)}),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.EDIT)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sửa")},s.a.createElement(J.a,{color:"primary",size:"small",onClick:()=>this.editItem(t)},s.a.createElement(D.a,null))),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.DELETE)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Xoá")},s.a.createElement(J.a,{color:"primary",size:"small",onClick:()=>this.deleteItem(t)},s.a.createElement(R.a,null))),!this.props.hideItemActions&&!this.props.itemActions&&this.hasRight(t,Ot.ADD)&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Sao chép")},s.a.createElement(J.a,{color:"primary",size:"small",onClick:()=>this.copyItem(t)},s.a.createElement(A.a,null))),!!this.props.itemActions&&this.props.itemActions(t,this)),s.a.createElement("div",{onClick:()=>{this.setState({rowSelected:t,load:this.state.load+1})},key:t._id,style:{flex:1,padding:10}},a.map(e=>{let a=t[e.id]||t[e.name||e.id];return a||0===a?s.a.createElement("div",{key:e.name},e.format?e.format(a,t,this,{whiteSpace:"nowrap"}):s.a.createElement(E.a,null,"value")):null})))}))})),s.a.createElement(q.a,null),this.props.hideHeader&&!this.props.readOnly&&!this.props.disabled&&(this.props.form||this.state.listInfo&&!0!==this.state.listInfo.not_add)&&this.renderAddButton(),(!this.props.hideHeader&&!this.props.renderItems||this.props.showPages)&&this.renderPages(!1))),s.a.createElement(Q.a,{item:!0,xs:12,sm:12,md:9,lg:9,style:{height:"100%",overflow:"hidden"}},i?s.a.createElement(bt.a,Pt({parent:this,_id:i._id,variant:"outlined",notShowViewDetail:!0,showForm:!0},this.props,{style:{height:"100%"},code:this.props.code||this.state.listInfo.code,data:{...i},onDataFullLoaded:t=>{let e=this.state.rows.find(e=>e._id===t._id);if(e)for(let a in t)e[a]=t[a]}})):s.a.createElement("div",{style:{backgroundColor:"white",height:"100%",padding:10}},s.a.createElement(E.a,null,"(",this.context.apis.getLabel("Không có dữ liệu"),")")))))}renderListView(t,e){if(!this.props.mediaQueryMatches&&!this.props.hideHeader&&!this.props.readOnly&&!this.props.disabled&&this.state.listInfo&&this.state.listInfo.show_view_tabs_on_grid){let a=t.filter(t=>t.is_title);if(a.length>0)return this.renderListTabs(t,e,a)}return s.a.createElement("div",{style:{overflow:"auto",width:"100%",display:"flex",flexDirection:"column",height:(this.props.hideHeader||this.props.mediaQueryMatches,"100%")}},t.length>0&&s.a.createElement(d.a,{style:{flex:1,backgroundColor:"white",borderRadius:4}},s.a.createElement(r.a,{stickyHeader:!0},!this.props.hideTableHeader&&s.a.createElement(h.a,null,s.a.createElement(u.a,null,(!this.props.hideItemActions||this.props.itemActions||0!=this.props.multiSel&&!this.props.hideHeader)&&"right"!==this.props.rowToolbarALign&&s.a.createElement(c.a,null,0!=this.props.multiSel&&!this.props.hideHeader&&s.a.createElement(Z.a,{size:"small",value:this.state.selAll,color:"primary",checked:this.state.selAll,onChange:this.selectAll})),t.map(t=>s.a.createElement(c.a,{key:t.id,align:t.align,style:{minWidth:t.minWidth,maxWidth:t.maxWidth||80}},s.a.createElement(Y.a,{title:t.label},s.a.createElement(E.a,{noWrap:!0},t.label)))),(!this.props.hideItemActions||this.props.itemActions||0!=this.props.multiSel&&!this.props.hideHeader)&&"right"===this.props.rowToolbarALign&&s.a.createElement(c.a,null,0!=this.props.multiSel&&!this.props.hideHeader&&s.a.createElement(Z.a,{size:"small",value:this.state.selAll,color:"secondary",checked:this.state.selAll,onChange:this.selectAll})))),s.a.createElement(n.a,{key:"_id",items:e,renderItem:e=>s.a.createElement(o.a,{key:e._id,row:e,COLUMNS:t,renderItem:(t,e)=>s.a.createElement(l.a,{tabIndex:-1},this.props.customRowView?this.props.customRowView(t,e,this):this.defaultRowView(t,e))})}))),this.props.hideHeader&&!this.props.readOnly&&!this.props.disabled&&(this.props.form||this.state.listInfo&&!0!==this.state.listInfo.not_add)&&this.renderAddButton(),(!this.props.hideHeader&&!this.props.renderItems||this.props.showPages)&&this.renderPages())}renderGridView(t,e){return s.a.createElement("div",{style:{overflow:"hidden"}},s.a.createElement(Q.a,{container:!0,spacing:2},s.a.createElement(n.a,{lazyLoad:!1,key:"_id",items:e,renderItem:e=>s.a.createElement(Q.a,{item:!0,xs:12,sm:12,md:4,lg:3},s.a.createElement(m.a,{style:{height:"100%",padding:0}},s.a.createElement(g.a,{style:{height:"100%",padding:0}},s.a.createElement(f.a,{style:{height:"100%",padding:0}},s.a.createElement(o.a,{row:e,COLUMNS:t,renderItem:(t,e)=>this.props.customCardView?this.props.customCardView(t,e,this):this.defaultCardView(t,e)})))))})),this.props.hideHeader&&!this.props.readOnly&&!this.props.disabled&&(this.props.form||this.state.listInfo&&!0!==this.state.listInfo.not_add)&&this.renderAddButton(),(!this.props.hideHeader&&!this.props.renderItems||this.props.showPages)&&this.renderPages())}renderItems(t,e,a){if(!this.api_code){let t=(new Date).getTime();a.filter(t=>void 0===t.line||null===t.line).forEach((e,a)=>{e.line=t+a})}return this.props.renderItems?s.a.createElement(s.a.Fragment,null,this.props.renderItems({typeDisplay:t,COLUMNS:e,rows:a,condition:this.condition||{},handleCellClicked:this.handleCellClicked}),this.props.hideHeader&&!this.props.readOnly&&!this.props.disabled&&(this.props.form||this.state.listInfo&&!0!==this.state.listInfo.not_add)&&this.renderAddButton(),(!this.props.hideHeader&&!this.props.renderItems||this.props.showPages)&&this.renderPages()):s.a.createElement(s.a.Fragment,null,"ListView"===t&&this.renderListView(e,a),"ListView"!==t&&this.renderGridView(e,a))}renderAddButton(){return s.a.createElement("div",{style:{textAlign:this.props.rowToolbarALign}},s.a.createElement(X.a,{startIcon:s.a.createElement(O.a,null),variant:"",color:"default",onClick:this.addItem.bind(this)},this.context.apis.getLabel("Thêm mới")))}renderPages(t=!0){const{page:e,rowsPerPage:a,totalRows:i,range_page:n}=this.state;return s.a.createElement("div",null,s.a.createElement(p.a,{rowsPerPageOptions:n,component:"div",count:i,rowsPerPage:a,labelRowsPerPage:t?this.context.apis.getLabel("Số dòng/trang"):"",backIconButtonText:this.context.apis.getLabel("Trước"),nextIconButtonText:this.context.apis.getLabel("Sau"),page:e,onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}renderOnlyImportData(){return s.a.createElement("div",{style:{display:"flex",flexDirection:"column",padding:20,justifyContent:"center",alignItems:"center",maxWidth:450}},s.a.createElement(X.a,{variant:"contained",fullWidth:!0,component:"label"},this.context.apis.getLabel("Nhập dữ liệu từ excel"),s.a.createElement("input",{type:"file",style:{display:"none"},onChange:t=>{const e=t.target.files;e.length>0&&this.importfromexcel(e[0])}})),s.a.createElement(X.a,{variant:"contained",fullWidth:!0,style:{marginTop:10},component:"label"},this.context.apis.getLabel("Nhập dữ liệu từ JSON"),s.a.createElement("input",{type:"file",style:{display:"none"},onChange:t=>{const e=t.target.files;e.length>0&&this.importfromjson(e[0])}})),s.a.createElement(X.a,{variant:"contained",fullWidth:!0,style:{marginTop:10},onClick:this.export2excel.bind(this)},this.context.apis.getLabel("Xuất dữ liệu ra excel")),s.a.createElement(X.a,{variant:"contained",fullWidth:!0,style:{marginTop:10},onClick:this.export2json.bind(this)},this.context.apis.getLabel("Xuất dữ liệu ra JSON")))}render(){if(this.props.onlyImportData)return s.a.createElement("div",{style:{padding:20,display:"flex",justifyContent:"center"}},this.renderOnlyImportData());const{listInfo:t}=this.state;if(!(t||this.props.form||this.props.columns||this.props.code))return null;let e=(t||{}).sort_by||this.props.sortBy;const a=(this.state.rows||[]).sort((t,a)=>((t,e,a="stt")=>{if(a.indexOf("{")>=0)return 0;let i=a.split(",");for(let a=0;a<i.length;a++){let s=i[a],n=t[s]||"",o=e[s]||"";if(n>o)return 1;if(n<o)return-1}return 0})(t,a,e));let i,n;if(!this.props.hideHeader){let t=this.props.backgroundColor||this.context.config.secondaryColor,e=Object(_t.gradientBackgroundStyle)(t,{brightenFirst:this.props.brightenFirst||this.context.config.fragBrightenFirst||50,brightenSecond:this.context.config.fragBrightenSecond});i=e.color,n=e.backgroundImage}if(!this.columns||0===this.columns.length){if(this.columns=this.props.columns,!this.columns&&t){const e=((t||{}).fields||[]).filter(t=>!this.isHidden(t,this.props.master,{}));this.columns=Object(ft.a)(e,this.context,this)}this.style={...this.props.style,display:"flex",color:i,flexDirection:"column",overflow:"hidden",backgroundImage:n},this.columns=this.columns||[],this.props.columnsView&&this.props.columnsView.length>0&&(this.columns=this.columns.filter(t=>this.props.columnsView.indexOf(t.name)>=0))}let o=this.state.typeDisplay;return s.a.createElement(s.a.Fragment,null,!this.props.noRender&&s.a.createElement("div",{style:this.style},s.a.createElement("div",null,this.props.description,!this.props.hideHeader&&s.a.createElement(Q.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",style:{marginBottom:10,marginTop:5}},s.a.createElement(Q.a,{item:!0,xs:12,sm:12,md:4},s.a.createElement(E.a,{noWrap:!0,variant:"title",component:"h3",style:{flex:1,color:i||this.context.config.titleColor}},this.context.apis.getLabel(this.props.label||(this.state.listInfo||{}).title||this.props.title||"...").toUpperCase())),s.a.createElement(Q.a,{item:!0,xs:12,sm:12,md:8,style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",paddingLeft:20}},(this.props.form||this.state.listInfo)&&(!this.state.listInfo||1!=this.state.listInfo.not_add)&&!this.props.readOnly&&!this.props.disabled&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Thêm mới dữ liệu")},s.a.createElement(X.a,{dataTour:"add",color:"primary",onClick:this.addItem.bind(this)},s.a.createElement(O.a,null))),!!this.state.listInfo&&1!=this.state.listInfo.not_delete&&!this.props.renderItems&&!this.props.readOnly&&!this.props.disabled&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Xoá các dòng đã chọn")},s.a.createElement(X.a,{dataTour:"delete",color:"primary",onClick:this.deleteItems.bind(this)},s.a.createElement(R.a,null))),!!this.state.listInfo&&this.props.print&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("In các dòng đã chọn")},s.a.createElement(X.a,{dataTour:"print",color:"primary",onClick:this.printItems.bind(this)},s.a.createElement(z.a,null))),s.a.createElement(xt.a,{ref:t=>this.menuImpExp=t,renderButton:t=>s.a.createElement(Y.a,{title:this.context.apis.getLabel("Nhập/xuất dữ liệu")},s.a.createElement(X.a,{dataTour:"impexp",color:"primary",onClick:t},s.a.createElement(N.a,null)))},s.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},s.a.createElement(s.a.Fragment,null,!!this.state.listInfo&&!this.props.readOnly&&!this.props.disabled&&s.a.createElement(X.a,{component:"label"},this.context.apis.getLabel("Nhập dữ liệu từ excel"),s.a.createElement("input",{type:"file",style:{display:"none"},onChange:t=>{const e=t.target.files;e.length>0&&this.importfromexcel(e[0])}}))),s.a.createElement(s.a.Fragment,null,!!this.state.listInfo&&!this.props.readOnly&&!this.props.disabled&&s.a.createElement(s.a.Fragment,null,s.a.createElement(q.a,null),s.a.createElement(X.a,{component:"label"},this.context.apis.getLabel("Nhập dữ liệu từ JSON"),s.a.createElement("input",{type:"file",style:{display:"none"},onChange:t=>{const e=t.target.files;e.length>0&&this.importfromjson(e[0])}})))),!!this.state.listInfo&&s.a.createElement(s.a.Fragment,null,s.a.createElement(q.a,null),s.a.createElement(X.a,{onClick:this.export2excel.bind(this)},this.context.apis.getLabel("Xuất dữ liệu ra excel"))),s.a.createElement(q.a,null),s.a.createElement(X.a,{onClick:this.export2json.bind(this)},this.context.apis.getLabel("Xuất dữ liệu ra JSON")))),this.props.code&&s.a.createElement(Y.a,{title:this.context.apis.getLabel("Lọc dữ liệu")},s.a.createElement(X.a,{dataTour:"filter",color:"primary",style:{marginRight:5},onClick:this.openSearch.bind(this)},s.a.createElement(S.a,null))),s.a.createElement(xt.a,{ref:t=>this.menuother=t,renderButton:t=>s.a.createElement(X.a,{onClick:t,color:"primary"},s.a.createElement(K.a,null))},s.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},s.a.createElement(y.a,null,this.props.code&&s.a.createElement(s.a.Fragment,null,s.a.createElement(xt.a,{ref:t=>this.menuCheck=t,renderButton:t=>s.a.createElement(b.a,{onClick:t,button:!0},s.a.createElement(_.a,null,s.a.createElement(w.a,{edge:"start"})),s.a.createElement(x.a,{primary:this.context.apis.getLabel("Kiểm tra trùng dữ liệu")}))},s.a.createElement("div",{style:{display:"flex",flexDirection:"column",padding:5}},s.a.createElement(y.a,null,this.columns.filter(t=>"Number"===t.type||"String"===t.type||"Date"===t.type||"DateTime"===t.type).map(t=>s.a.createElement(b.a,{key:t.name},s.a.createElement(_.a,null,s.a.createElement(Z.a,{edge:"start",checked:t.sel,tabIndex:-1,onChange:e=>this.selColumn(t,e)})),s.a.createElement(x.a,{primary:this.context.apis.getLabel(t.label)})))),s.a.createElement(X.a,{fullWidth:!0,variant:"outlined",color:"default",onClick:this.checkDuplicate.bind(this)},this.context.apis.getLabel("Kiểm tra")))),s.a.createElement(q.a,null)),!!this.props.optionsFormCode&&s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a,{onClick:this.options.bind(this),button:!0},s.a.createElement(_.a,null,s.a.createElement(k.a,{edge:"start"})),s.a.createElement(x.a,{primary:this.context.apis.getLabel("Tuỳ chọn")})),s.a.createElement(q.a,null)),s.a.createElement(at.a,{smDown:!0,implementation:"js"},"GridView"===o&&!this.props.renderItems&&s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a,{onClick:()=>{this.menuother.close(),this.setState({typeDisplay:"ListView",load:this.state.load+1})},button:!0},s.a.createElement(_.a,null,s.a.createElement(G.a,{edge:"start"})),s.a.createElement(x.a,{primary:this.context.apis.getLabel("Hiện dưới dạng danh sách")})),s.a.createElement(q.a,null)),"ListView"===o&&!this.props.renderItems&&s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a,{onClick:()=>{this.menuother.close(),this.setState({typeDisplay:"GridView",load:this.state.load+1})},button:!0},s.a.createElement(_.a,null,s.a.createElement($.a,{edge:"start"})),s.a.createElement(x.a,{primary:this.context.apis.getLabel("Hiện dưới dạng lưới")})),s.a.createElement(q.a,null)),s.a.createElement(b.a,{onClick:this.tour.bind(this),button:!0},s.a.createElement(_.a,null,s.a.createElement(M.a,{edge:"start"})),s.a.createElement(x.a,{primary:this.context.apis.getLabel("Hướng dẫn")})))))),this.props.extraActions&&this.props.extraActions(this)))),s.a.createElement("div",{style:{flex:1,overflow:"auto"}},this.renderItems(o,this.columns,a))),s.a.createElement(mt.a,{key:(this.props.listInfo||{}).code||this.props.code,code:this.props.code,fullWidth:!0,ref:t=>this.mainFormRef=t,fullScreen:this.props.fullScreen,form:this.props.form,listInfo:this.state.listInfo,title:this.props.title||this.props.label||(this.state.listInfo||{}).title,saveItem:t=>this.saveItem(t),copyItem:t=>this.copyItem(t),deleteItem:t=>this.deleteItem(t),dataPickers:this.props.dataPickers,parent:this}),!this.props.noRender&&this.state.PrintDialog,!this.props.noRender&&this.state.OptionsForm,!this.props.noRender&&this.state.TourGuide,!this.props.noRender&&this.state.printFrame,!this.props.noRender&&this.state.SearchFormComponent)}}Lt.contextType=ut.a,Lt.propTypes={code:kt.a.string,listInfo:kt.a.object,title:kt.a.any,label:kt.a.any,description:kt.a.any,columns:kt.a.arrayOf(kt.a.object),columnsView:kt.a.arrayOf(kt.a.string),rows:kt.a.arrayOf(kt.a.object),rowsPerPage:kt.a.number,master:kt.a.object,customRowView:kt.a.func,customCardView:kt.a.func,form:kt.a.func,formCode:kt.a.string,searchForm:kt.a.func,defaultCondition:kt.a.object,requiredCondition:kt.a.object,hasRight:kt.a.func,defaultData:kt.a.object,dataPickers:kt.a.object,backgroundColor:kt.a.string,brightenFirst:kt.a.number,validationConstraints:kt.a.object,dataRequired:kt.a.object,formSize:kt.a.oneOf(["sm","md","lg"]),noRender:kt.a.bool,hideTableHeader:kt.a.bool,hideHeader:kt.a.bool,showPages:kt.a.bool,readOnly:kt.a.bool,disabled:kt.a.bool,hideItemActions:kt.a.bool,multiSel:kt.a.bool,isDrilldown:kt.a.bool,print:kt.a.bool,fullScreen:kt.a.bool,onlyImportData:kt.a.bool,optionsFormCode:kt.a.string,defaultOptionsCode:kt.a.string,sortBy:kt.a.string,style:kt.a.object,itemActions:kt.a.func,rowToolbarALign:kt.a.string,typeDisplay:kt.a.oneOf(["ListView","GridView"]),onRowsChanged:kt.a.func,onDelete:kt.a.func,onDeleted:kt.a.func,onSave:kt.a.func,onLoadData:kt.a.func,renderItems:kt.a.func,handleCellClicked:kt.a.func,extraActions:kt.a.func,history:kt.a.any.isRequired,match:kt.a.any,mediaQueryMatches:kt.a.bool},Lt.ACTIONS=Ot,e.default=Lt}.call(this,a(518).setImmediate)},489:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t&&"number"==typeof t.length&&t.length>=0&&t.length%1==0},t.exports=e.default},490:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={},t.exports=e.default},491:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e=t.length){if(!e)throw new Error("arity is undefined");return function(...a){return"function"==typeof a[e-1]?t.apply(this,a):new Promise((i,s)=>{a[e-1]=(t,...e)=>{if(t)return s(t);i(e.length>1?e:e[0])},t.apply(this,a)})}},t.exports=e.default},507:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");e.default=o},518:function(t,e,a){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new n(s.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new n(s.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},a(606),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,a(76))},522:function(t,e,a){"use strict";function i(t,e){if(!t)return{};const a={};return t.forEach(t=>{t.required&&(a[t.name]={presence:{allowEmpty:!1,message:"^"+e.apis.getLabel("Bạn chưa nhập "+(t.header||"").toLowerCase())}})}),a}a.d(e,"a",(function(){return i}))},544:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var i=a(386),s=a.n(i);async function n(t,e,a,i={},n="",o=[]){e&&await Promise.all(e.filter(t=>!!t.default&&o.indexOf(t.default)<0&&"Link"!==t.type&&"Action"!==t.type).map(async e=>{let o=`return (async ()=>{\n      ${e.default.indexOf("return ")>=0?e.default:"return "+e.default}\n    })()`;try{const r=new Function("master","API","Moment","token","context",o);let l=await r(i,a.apis,s.a,n,a);switch(e.type){case"String":l=(l||"").toString();break;case"Number":l=Number(l||0);break;case"Date":"object"!=typeof l&&(l=new Date(l))}return t[e.name]=l,{[e.name]:l}}catch(t){return console.error("default value error:",t.message,e.default),{[e.name]:null}}}))}},545:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){function e(...e){if(null!==t){var a=t;t=null,a.apply(this,e)}}return Object.assign(e,t),e},t.exports=e.default},546:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(...e){if(null===t)throw new Error("Callback was already called.");var a=t;t=null,a.apply(this,e)}},t.exports=e.default},562:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings");e.default=o},563:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");e.default=o},592:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddCircle");e.default=o},606:function(t,e,a){(function(t,e){!function(t,a){"use strict";if(!t.setImmediate){var i,s,n,o,r,l=1,c={},d=!1,h=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){m(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}()?t.MessageChannel?((n=new MessageChannel).port1.onmessage=function(t){m(t.data)},i=function(t){n.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(s=h.documentElement,i=function(t){var e=h.createElement("script");e.onreadystatechange=function(){m(t),e.onreadystatechange=null,s.removeChild(e),e=null},s.appendChild(e)}):i=function(t){setTimeout(m,0,t)}:(o="setImmediate$"+Math.random()+"$",r=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&m(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),i=function(e){t.postMessage(o+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var s={callback:t,args:e};return c[l]=s,i(l),l++},p.clearImmediate=u}function u(t){delete c[t]}function m(t){if(d)setTimeout(m,0,t);else{var e=c[t];if(e){d=!0;try{!function(t){var e=t.callback,a=t.args;switch(a.length){case 0:e();break;case 1:e(a[0]);break;case 2:e(a[0],a[1]);break;case 3:e(a[0],a[1],a[2]);break;default:e.apply(void 0,a)}}(e)}finally{u(t),d=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,a(76),a(447))},609:function(t,e,a){"use strict";var i=a(12),s=a(368),n=a(1),o=(a(55),a(369)),r=a(370),l=a(378),c=n.forwardRef((function(t,e){var a=t.classes,r=t.className,c=t.color,d=void 0===c?"primary":c,h=t.disableShrink,p=void 0!==h&&h,u=t.size,m=void 0===u?40:u,f=t.style,g=t.thickness,y=void 0===g?3.6:g,b=t.value,x=void 0===b?0:b,_=t.variant,v=void 0===_?"indeterminate":_,w=Object(s.a)(t,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),E={},I={},k={};if("determinate"===v||"static"===v){var C=2*Math.PI*((44-y)/2);E.strokeDasharray=C.toFixed(3),k["aria-valuenow"]=Math.round(x),E.strokeDashoffset="".concat(((100-x)/100*C).toFixed(3),"px"),I.transform="rotate(-90deg)"}return n.createElement("div",Object(i.a)({className:Object(o.a)(a.root,r,"inherit"!==d&&a["color".concat(Object(l.a)(d))],{determinate:a.determinate,indeterminate:a.indeterminate,static:a.static}[v]),style:Object(i.a)({width:m,height:m},I,f),ref:e,role:"progressbar"},k,w),n.createElement("svg",{className:a.svg,viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44)},n.createElement("circle",{className:Object(o.a)(a.circle,p&&a.circleDisableShrink,{determinate:a.circleDeterminate,indeterminate:a.circleIndeterminate,static:a.circleStatic}[v]),style:E,cx:44,cy:44,r:(44-y)/2,fill:"none",strokeWidth:y})))}));e.a=Object(r.a)((function(t){return{root:{display:"inline-block"},static:{transition:t.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},determinate:{transition:t.transitions.create("transform")},colorPrimary:{color:t.palette.primary.main},colorSecondary:{color:t.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:t.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},circleDeterminate:{transition:t.transitions.create("stroke-dashoffset")},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}}),{name:"MuiCircularProgress",flip:!1})(c)},623:function(t,e,a){"use strict";var i=a(1),s=a.n(i),n=a(391),o=a.n(n),r=a(418),l=a.n(r),c=a(374),d=a(55),h=a.n(d);class p extends s.a.Component{constructor(t){super(t),this.row=l()(this.props.row),this.COLUMNS=l()(this.props.COLUMNS)}shouldComponentUpdate(t){return o()(t.row,this.row)?!o()(t.COLUMNS,this.COLUMNS)&&(this.COLUMNS=l()(t.COLUMNS),!0):(this.row=l()(t.row),!0)}render(){let{row:t,COLUMNS:e}=this;return s.a.createElement(s.a.Fragment,null,this.props.renderItem?this.props.renderItem(t,e):null)}}p.contextType=c.a,p.propTypes={row:h.a.object.isRequired,COLUMNS:h.a.any,renderItem:h.a.func.isRequired},e.a=p},624:function(t,e,a){"use strict";var i=a(1),s=a.n(i),n=a(669),o=a(671),r=a(480),l=a(1709),c=a(507),d=a.n(c),h=a(77),p=a(55),u=a.n(p),m=a(374),f=a(1748),g=a(1724),y=a(737),b=a(401),x=a(386),_=a.n(x),v=a(430),w=a.n(v),E=a(512),I=a(472),k=a.n(I),C=a(391),S=a.n(C),P=a(1706),O=a(501);class L extends s.a.PureComponent{constructor(t){super(t);let e=Number(this.props.currentTab||0);this.state={load:0,currentTab:e,obj:null,listinfo:null,tabData:null},this.loadData=this.loadData.bind(this)}async componentDidMount(){const{default:t}=await Promise.resolve().then(a.bind(null,488)),{default:e}=await Promise.all([a.e(10),a.e(16),a.e(54)]).then(a.bind(null,697)),{default:i}=await a.e(40).then(a.bind(null,814)),{default:s}=await Promise.all([a.e(3),a.e(2),a.e(5),a.e(7),a.e(17)]).then(a.bind(null,526));this.setState({InputBase:t,ChatRoom:e,GridTask:i,FormBase:s,load:this.state.load+1},async()=>{this.titleContainer=document.getElementById("view-title-container"),await this.loadConfig(),await this.loadData()})}componentDidUpdate(t){return this.props.data&&this.props.data._id&&!S()(this.props.data,t.data)||t._id!==this.props._id?this.loadData():void 0}setTab(t){let{obj:e,listinfo:a}=this.state;if(!a||!a.view_tabs||a.view_tabs.length-1<t)return void this.setState({tabData:null,load:this.state.load+1});let i,n,o,r,l=a.view_tabs[t];if(l.default_condition){i=new Function("master","return "+l.default_condition)(e)}if(l.default_data){n=new Function("master","return "+l.default_data)(e)}if(l.data_pickers){o=new Function("master","return "+l.data_pickers)(e)}switch(l.code){case"detailform":r=s.a.createElement(s.a.Fragment,null,this.state.FormBase&&s.a.createElement(this.state.FormBase,{parent:this.props.parent,style:{height:"100%",overflow:"auto"},readOnly:!0,code:a.code,fields:a.fields,data:e}));break;case"chatroom":{let t=[...e.attends];t.push(e.user_created),t=[...new Set(t)];let i=a.title,n=a.fields.find(t=>t.is_title);n&&(i=e[n.name]),r=s.a.createElement(s.a.Fragment,null,this.state.ChatRoom&&s.a.createElement(this.state.ChatRoom,{idLink:e._id,codeLink:a.code,attends:t,phuTrach:e.phu_trach,title:i}));break}case"file":r=s.a.createElement("div",null,s.a.createElement(E.a,{idLink:e._id}));break;case"task":{let t=a.title,o=a.fields.find(t=>t.is_title);o&&(t=e[o.name]),n||(n={id_link:e._id}),i||(i={id_link:e._id}),n={...n,phu_trach:e.phu_trach,attends:e.attends,group_id_link:e._id,group_name_link:t},r=s.a.createElement(s.a.Fragment,null,this.state.GridTask&&s.a.createElement(this.state.GridTask,{style:{height:"100%"},defaultData:n,defaultCondition:i,history:this.props.history,mediaQueryMatches:this.props.mediaQueryMatches,showTimeline:!1,showLabels:!1,onRowsChanged:()=>{}}))}break;default:r=s.a.createElement(s.a.Fragment,null,this.state.InputBase&&s.a.createElement(this.state.InputBase,{hideHeader:!0,defaultCondition:i,defaultData:n,dataPickers:o,rowToolbarALign:"left",hideItemActions:!0,code:l.code,rowsPerPage:30,onRowsChanged:()=>{}}))}this.setState({currentTab:t,tabData:r,load:this.state.load+1})}async loadData(){if(!this.api_code)return;if(this.props.data&&this.props.data.is_full_data)return void this.setState({obj:this.props.data,load:this.state.load+1},()=>{this.setTab(0)});const t={_id:this.props._id};this.context.setProgressStatus(!0);try{const e=await this.context.apis.asyncGetData(this.context.userInfo.token,this.api_code,t);if(!e)return this.context.alert(this.context.apis.getLabel("Dữ liệu không tồn tại"));this.props.onDataFullLoaded&&this.props.onDataFullLoaded({...e,is_full_data:!0}),this.setState({obj:e,load:this.state.load+1},()=>{this.setTab(0)}),this.context.setProgressStatus(!1)}catch(t){this.context.alert(t.message)}}async loadConfig(){const t={code:this.props.code};this.context.setProgressStatus(!0);try{const e=await this.context.apis.asyncGetData(this.context.userInfo.token,"listinfo",t);if(!e)return this.context.alert(this.context.apis.getLabel("Danh mục không tồn tại"));e.view_tabs=e.view_tabs||[],0===e.view_tabs.length&&(e.view_tabs.push({code:"task",name:"Công việc"}),e.view_tabs.push({code:"chatroom",name:"Thảo luận"})),this.props.showForm&&(e.view_tabs=[{code:"detailform",name:"Chi tiết"}].concat(e.view_tabs));let a=e.fields.filter(t=>t.on_view);this.api_code=e.api_code||this.props.code,this.setState({listinfo:e,fieldsOnView:a,load:this.state.load+1}),this.context.setProgressStatus(!1)}catch(t){this.context.alert(t.message)}}editNode(){this._list.quickEdit(this.state.obj,t=>{this.setState({obj:t,load:this.state.load+1})},()=>{this.props.history.goBack()})}renderField(t){const{obj:e}=this.state;let a,i=t.header,n=e[t.ref_label_as||t.ref_label||t.name]||e[t.name];if(n&&"date"===t.type.toLowerCase()&&(n=_()(n).format("DD/MM/YYYY")),n&&"datetime"===t.type.toLowerCase()&&(n=_()(n).format("DD/MM/YYYY HH:mm A")),n&&"time"===t.type.toLowerCase()&&(n=_()(n).format("HH:mm A")),k()(n)&&"number"===t.type.toLowerCase()&&(n=w()(n).format()),t.grid_configs)try{a=new Function("data",(t.grid_configs.includes("return ")?"":"return ")+t.grid_configs)({})}catch(e){console.error(e.message,t.grid_configs)}else a={};let o=n;if(a.render&&n){let t=(a.render.indexOf("return ")<0?"return ":"")+a.render;try{o=new Function("row","data","master","value","style","server_url","context",t)(e,e,e,n,{},this.context.config.server_url,this.context)}catch(t){o=t.message}o=s.a.createElement("div",{dangerouslySetInnerHTML:{__html:o}})}return t.is_title?s.a.createElement(s.a.Fragment,null,this.titleContainer&&n&&s.a.createElement(P.a,{container:this.titleContainer},s.a.createElement("span",null,n)),s.a.createElement(l.a,{key:t.line.toString(),variant:"h5",style:{marginTop:15,textAlign:"center"}},o||"--")):s.a.createElement("div",{key:t.line.toString(),style:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",marginTop:25}},s.a.createElement(l.a,{variant:"div"},this.context.apis.getLabel(i)),s.a.createElement(l.a,{style:{fontWeight:"bold",marginTop:5},variant:"title"},o||"--"))}render(){let{obj:t,listinfo:e,fieldsOnView:a,tabData:i}=this.state;if(!t||!e)return null;e.view_tabs||(e.view_tabs=[]);const{getLabel:c}=this.context.apis;let p=this.context.config.secondaryColor,u=Object(b.gradientBackgroundStyle)(p,{brightenFirst:this.context.config.fragBrightenFirst||50}),m=u.color,x=u.backgroundImage,_={...this.props.style};return this.props.mediaQueryMatches&&delete _.height,s.a.createElement("div",{style:_},s.a.createElement("div",{style:{height:"100%",overflow:"hidden"}},s.a.createElement(r.a,{container:!0,spacing:this.props.notShowViewDetail?0:1,style:{height:"100%"}},!0!==this.props.notShowViewDetail&&s.a.createElement(r.a,{item:!0,xs:12,sm:12,md:3,lg:3,style:{height:"100%",overflow:"hidden"}},s.a.createElement(o.a,{variant:this.props.variant,style:{position:"relative",height:"100%",overflow:"hidden",padding:0}},s.a.createElement("div",{style:{padding:10,overflow:"auto",height:"100%",color:m,backgroundImage:x}},s.a.createElement(h.c,{to:"/list/"+e.code},s.a.createElement(l.a,{variant:"body2"},c(e.title))),a.filter(t=>t.is_title).map(t=>this.renderField(t)),a.filter(t=>!t.is_title).map(t=>this.renderField(t))),s.a.createElement(n.a,{size:"small",onClick:()=>this.editNode(),style:{position:"absolute",right:1,top:1,color:m,fontSize:18}},s.a.createElement(d.a,null)))),s.a.createElement(r.a,{item:!0,xs:12,sm:12,md:!0!==this.props.notShowViewDetail?9:12,lg:!0!==this.props.notShowViewDetail?9:12,style:{height:"100%"}},s.a.createElement(o.a,{variant:this.props.variant,style:{height:"100%",overflow:"hidden",padding:0}},s.a.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},s.a.createElement(y.a,{position:"static",color:"default",elevation:0},s.a.createElement(f.a,{value:this.state.currentTab,variant:"scrollable",scrollButtons:"auto",onChange:(t,e)=>this.setTab(e)},e.view_tabs.map((e,a)=>"chatroom"===e.code?s.a.createElement(g.a,{label:s.a.createElement(O.a,{idLink:t._id},s.a.createElement("span",null,c("Thảo luận")))}):s.a.createElement(g.a,{key:a.toString(),label:c(e.name)})))),s.a.createElement("div",{style:{flex:1,overflow:"auto"}},i)))))),!0!==this.props.notShowViewDetail&&this.state.InputBase&&s.a.createElement(this.state.InputBase,{noRender:!0,code:this.props.code,rowsPerPage:1,ref:t=>this._list=t}))}}L.contextType=m.a,L.propTypes={_id:u.a.string.isRequired,data:u.a.any,code:u.a.string.isRequired,history:u.a.any,match:u.a.any,parent:u.a.any,location:u.a.any,defaultData:u.a.any,currentTab:u.a.number,defaultCondition:u.a.any,variant:u.a.oneOf(["elevation","outlined"]),notShowViewDetail:u.a.bool,showForm:u.a.bool,mediaQueryMatches:u.a.bool,style:u.a.any,onDataFullLoaded:u.a.func},e.a=L},625:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return(0,s.default)(i.default,t,e)};var i=n(a(626)),s=n(a(635));function n(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default},626:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=d(a(489)),s=d(a(490)),n=d(a(627)),o=d(a(545)),r=d(a(546)),l=d(a(438)),c=d(a(491));function d(t){return t&&t.__esModule?t:{default:t}}function h(t,e,a){a=(0,o.default)(a);var i=0,n=0,{length:l}=t,c=!1;function d(t,e){!1===t&&(c=!0),!0!==c&&(t?a(t):++n!==l&&e!==s.default||a(null))}for(0===l&&a(null);i<l;i++)e(t[i],i,(0,r.default)(d))}function p(t,e,a){return(0,n.default)(t,1/0,e,a)}e.default=(0,c.default)((function(t,e,a){return((0,i.default)(t)?h:p)(t,(0,l.default)(e),a)}),3),t.exports=e.default},627:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(a(628)),s=o(a(438)),n=o(a(491));function o(t){return t&&t.__esModule?t:{default:t}}e.default=(0,n.default)((function(t,e,a,n){return(0,i.default)(e)(t,(0,s.default)(a),n)}),4),t.exports=e.default},628:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c(a(545)),s=c(a(629)),n=c(a(546)),o=a(438),r=c(a(634)),l=c(a(490));function c(t){return t&&t.__esModule?t:{default:t}}e.default=t=>(e,a,c)=>{if(c=(0,i.default)(c),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return c(null);if((0,o.isAsyncGenerator)(e))return(0,r.default)(e,t,a,c);if((0,o.isAsyncIterable)(e))return(0,r.default)(e[Symbol.asyncIterator](),t,a,c);var d=(0,s.default)(e),h=!1,p=!1,u=0,m=!1;function f(t,e){if(!p)if(u-=1,t)h=!0,c(t);else if(!1===t)h=!0,p=!0;else{if(e===l.default||h&&u<=0)return h=!0,c(null);m||g()}}function g(){for(m=!0;u<t&&!h;){var e=d();if(null===e)return h=!0,void(u<=0&&c(null));u+=1,a(e.value,e.key,(0,n.default)(f))}m=!1}g()},t.exports=e.default},629:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if((0,i.default)(t))return function(t){var e=-1,a=t.length;return function(){return++e<a?{value:t[e],key:e}:null}}(t);var e=(0,s.default)(t);return e?function(t){var e=-1;return function(){var a=t.next();return a.done?null:(e++,{value:a.value,key:e})}}(e):(a=t,n=a?Object.keys(a):[],o=-1,r=n.length,function(){var t=n[++o];return o<r?{value:a[t],key:t}:null});var a,n,o,r};var i=n(a(489)),s=n(a(630));function n(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default},630:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},t.exports=e.default},631:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if((0,n.isAsync)(t))return function(...e){const a=e.pop();return r(t.apply(this,e),a)};return(0,i.default)((function(e,a){var i;try{i=t.apply(this,e)}catch(t){return a(t)}if(i&&"function"==typeof i.then)return r(i,a);a(null,i)}))};var i=o(a(632)),s=o(a(633)),n=a(438);function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return t.then(t=>{l(e,null,t)},t=>{l(e,t&&t.message?t:new Error(t))})}function l(t,e,a){try{t(e,a)}catch(t){(0,s.default)(t=>{throw t},t)}}t.exports=e.default},632:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(...e){var a=e.pop();return t.call(this,e,a)}},t.exports=e.default},633:function(t,e,a){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.fallback=o,e.wrap=r;var i,s=e.hasSetImmediate="function"==typeof t&&t,n=e.hasNextTick="object"==typeof a&&"function"==typeof a.nextTick;function o(t){setTimeout(t,0)}function r(t){return(e,...a)=>t(()=>e(...a))}i=s?t:n?a.nextTick:o,e.default=r(i)}).call(this,a(518).setImmediate,a(447))},634:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,a,i){let s=!1,o=!1,r=!1,l=0,c=0;function d(){l>=e||r||s||(r=!0,t.next().then(({value:t,done:e})=>{if(!o&&!s){if(r=!1,e)return s=!0,void(l<=0&&i(null));l++,a(t,c,h),c++,d()}}).catch(p))}function h(t,e){if(l-=1,!o)return t?p(t):!1===t?(s=!0,void(o=!0)):e===n.default||s&&l<=0?(s=!0,i(null)):void d()}function p(t){o||(r=!1,s=!0,i(t))}d()};var i,s=a(490),n=(i=s)&&i.__esModule?i:{default:i};t.exports=e.default},635:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(a(489)),s=o(a(438)),n=o(a(491));function o(t){return t&&t.__esModule?t:{default:t}}e.default=(0,n.default)((t,e,a)=>{var n=(0,i.default)(e)?[]:{};t(e,(t,e,a)=>{(0,s.default)(t)((t,...i)=>{i.length<2&&([i]=i),n[e]=i,a(t)})},t=>a(t,n))},3),t.exports=e.default},636:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"}),"FileCopy");e.default=o},637:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M9 3L5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport");e.default=o},638:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M4 14h4v-4H4v4zm0 5h4v-4H4v4zM4 9h4V5H4v4zm5 5h12v-4H9v4zm0 5h12v-4H9v4zM9 5v4h12V5H9z"}),"ViewList");e.default=o},639:function(t,e,a){"use strict";var i=a(371),s=a(372);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a(1)),o=(0,i(a(373)).default)(n.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"}),"Help");e.default=o},646:function(t,e,a){"use strict";a.d(e,"a",(function(){return lt}));var i=a(1),s=a.n(i),n=a(386),o=a.n(n),r=a(430),l=a.n(r),c=a(1709),d=a(77),h=a(1703),p=a(12),u=a(368),m=(a(55),a(369)),f=a(378),g=a(370),y=a(395),b=a(415),x=i.forwardRef((function(t,e){var a=t.classes,s=t.className,n=t.color,o=void 0===n?"primary":n,r=t.value,l=t.valueBuffer,c=t.variant,d=void 0===c?"indeterminate":c,h=Object(u.a)(t,["classes","className","color","value","valueBuffer","variant"]),g=Object(b.a)(),y={},x={bar1:{},bar2:{}};if("determinate"===d||"buffer"===d)if(void 0!==r){y["aria-valuenow"]=Math.round(r),y["aria-valuemin"]=0,y["aria-valuemax"]=100;var _=r-100;"rtl"===g.direction&&(_=-_),x.bar1.transform="translateX(".concat(_,"%)")}else 0;if("buffer"===d)if(void 0!==l){var v=(l||0)-100;"rtl"===g.direction&&(v=-v),x.bar2.transform="translateX(".concat(v,"%)")}else 0;return i.createElement("div",Object(p.a)({className:Object(m.a)(a.root,a["color".concat(Object(f.a)(o))],s,{determinate:a.determinate,indeterminate:a.indeterminate,buffer:a.buffer,query:a.query}[d]),role:"progressbar"},y,{ref:e},h),"buffer"===d?i.createElement("div",{className:Object(m.a)(a.dashed,a["dashedColor".concat(Object(f.a)(o))])}):null,i.createElement("div",{className:Object(m.a)(a.bar,a["barColor".concat(Object(f.a)(o))],("indeterminate"===d||"query"===d)&&a.bar1Indeterminate,{determinate:a.bar1Determinate,buffer:a.bar1Buffer}[d]),style:x.bar1}),"determinate"===d?null:i.createElement("div",{className:Object(m.a)(a.bar,("indeterminate"===d||"query"===d)&&a.bar2Indeterminate,"buffer"===d?[a["color".concat(Object(f.a)(o))],a.bar2Buffer]:a["barColor".concat(Object(f.a)(o))]),style:x.bar2}))})),_=Object(g.a)((function(t){var e=function(e){return"light"===t.palette.type?Object(y.f)(e,.62):Object(y.b)(e,.5)},a=e(t.palette.primary.main),i=e(t.palette.secondary.main);return{root:{position:"relative",overflow:"hidden",height:4,"@media print":{colorAdjust:"exact"}},colorPrimary:{backgroundColor:a},colorSecondary:{backgroundColor:i},determinate:{},indeterminate:{},buffer:{backgroundColor:"transparent"},query:{transform:"rotate(180deg)"},dashed:{position:"absolute",marginTop:0,height:"100%",width:"100%",animation:"$buffer 3s infinite linear"},dashedColorPrimary:{backgroundImage:"radial-gradient(".concat(a," 0%, ").concat(a," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},dashedColorSecondary:{backgroundImage:"radial-gradient(".concat(i," 0%, ").concat(i," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},bar:{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},barColorPrimary:{backgroundColor:t.palette.primary.main},barColorSecondary:{backgroundColor:t.palette.secondary.main},bar1Indeterminate:{width:"auto",animation:"$indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite"},bar1Determinate:{transition:"transform .".concat(4,"s linear")},bar1Buffer:{zIndex:1,transition:"transform .".concat(4,"s linear")},bar2Indeterminate:{width:"auto",animation:"$indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite"},bar2Buffer:{transition:"transform .".concat(4,"s linear")},"@keyframes indeterminate1":{"0%":{left:"-35%",right:"100%"},"60%":{left:"100%",right:"-90%"},"100%":{left:"100%",right:"-90%"}},"@keyframes indeterminate2":{"0%":{left:"-200%",right:"100%"},"60%":{left:"107%",right:"-8%"},"100%":{left:"107%",right:"-8%"}},"@keyframes buffer":{"0%":{opacity:1,backgroundPosition:"0 -23px"},"50%":{opacity:0,backgroundPosition:"0 -23px"},"100%":{opacity:1,backgroundPosition:"-200px -23px"}}}}),{name:"MuiLinearProgress"})(x),v=a(609),w=a(527),E=a(534);function I(t,e){var a={};return Object.keys(t).forEach((function(i){-1===e.indexOf(i)&&(a[i]=t[i])})),a}function k(t){var e=function(e){var a=t(e);return e.css?Object(p.a)({},Object(E.a)(a,t(Object(p.a)({theme:e.theme},e.css))),I(e.css,[t.filterProps])):e.sx?Object(p.a)({},Object(E.a)(a,t(Object(p.a)({theme:e.theme},e.sx))),I(e.sx,[t.filterProps])):a};return e.propTypes={},e.filterProps=["css","sx"].concat(Object(w.a)(t.filterProps)),e}var C=k;var S=function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];var i=function(t){return e.reduce((function(e,a){var i=a(t);return i?Object(E.a)(e,i):e}),{})};return i.propTypes={},i.filterProps=e.reduce((function(t,e){return t.concat(e.filterProps)}),[]),i},P=a(388),O=a(665);function L(t,e){return e&&"string"==typeof e?e.split(".").reduce((function(t,e){return t&&t[e]?t[e]:null}),t):null}var D=function(t){var e=t.prop,a=t.cssProperty,i=void 0===a?t.prop:a,s=t.themeKey,n=t.transform,o=function(t){if(null==t[e])return null;var a=t[e],o=L(t.theme,s)||{};return Object(O.a)(t,a,(function(t){var e;return"function"==typeof o?e=o(t):Array.isArray(o)?e=o[t]||t:(e=L(o,t)||t,n&&(e=n(e))),!1===i?e:Object(P.a)({},i,e)}))};return o.propTypes={},o.filterProps=[e],o};function j(t){return"number"!=typeof t?t:"".concat(t,"px solid")}var R=S(D({prop:"border",themeKey:"borders",transform:j}),D({prop:"borderTop",themeKey:"borders",transform:j}),D({prop:"borderRight",themeKey:"borders",transform:j}),D({prop:"borderBottom",themeKey:"borders",transform:j}),D({prop:"borderLeft",themeKey:"borders",transform:j}),D({prop:"borderColor",themeKey:"palette"}),D({prop:"borderRadius",themeKey:"shape"})),T=S(D({prop:"displayPrint",cssProperty:!1,transform:function(t){return{"@media print":{display:t}}}}),D({prop:"display"}),D({prop:"overflow"}),D({prop:"textOverflow"}),D({prop:"visibility"}),D({prop:"whiteSpace"})),A=S(D({prop:"flexBasis"}),D({prop:"flexDirection"}),D({prop:"flexWrap"}),D({prop:"justifyContent"}),D({prop:"alignItems"}),D({prop:"alignContent"}),D({prop:"order"}),D({prop:"flex"}),D({prop:"flexGrow"}),D({prop:"flexShrink"}),D({prop:"alignSelf"}),D({prop:"justifyItems"}),D({prop:"justifySelf"})),F=S(D({prop:"gridGap"}),D({prop:"gridColumnGap"}),D({prop:"gridRowGap"}),D({prop:"gridColumn"}),D({prop:"gridRow"}),D({prop:"gridAutoFlow"}),D({prop:"gridAutoColumns"}),D({prop:"gridAutoRows"}),D({prop:"gridTemplateColumns"}),D({prop:"gridTemplateRows"}),D({prop:"gridTemplateAreas"}),D({prop:"gridArea"})),M=S(D({prop:"position"}),D({prop:"zIndex",themeKey:"zIndex"}),D({prop:"top"}),D({prop:"right"}),D({prop:"bottom"}),D({prop:"left"})),B=S(D({prop:"color",themeKey:"palette"}),D({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"})),z=D({prop:"boxShadow",themeKey:"shadows"});function H(t){return t<=1?"".concat(100*t,"%"):t}var N=D({prop:"width",transform:H}),q=D({prop:"maxWidth",transform:H}),V=D({prop:"minWidth",transform:H}),G=D({prop:"height",transform:H}),W=D({prop:"maxHeight",transform:H}),$=D({prop:"minHeight",transform:H}),U=(D({prop:"size",cssProperty:"width",transform:H}),D({prop:"size",cssProperty:"height",transform:H}),S(N,q,V,G,W,$,D({prop:"boxSizing"}))),K=a(1756),Y=S(D({prop:"fontFamily",themeKey:"typography"}),D({prop:"fontSize",themeKey:"typography"}),D({prop:"fontStyle",themeKey:"typography"}),D({prop:"fontWeight",themeKey:"typography"}),D({prop:"letterSpacing"}),D({prop:"lineHeight"}),D({prop:"textAlign"})),X=a(111),J=a.n(X),Q=a(1745);function Z(t,e){var a={};return Object.keys(t).forEach((function(i){-1===e.indexOf(i)&&(a[i]=t[i])})),a}var tt=a(533),et=function(t){var e=function(t){return function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a.name,n=Object(u.a)(a,["name"]);var o,r=i,l="function"==typeof e?function(t){return{root:function(a){return e(Object(p.a)({theme:t},a))}}}:{root:e},c=Object(Q.a)(l,Object(p.a)({Component:t,name:i||t.displayName,classNamePrefix:r},n));e.filterProps&&(o=e.filterProps,delete e.filterProps),e.propTypes&&(e.propTypes,delete e.propTypes);var d=s.a.forwardRef((function(e,a){var i=e.children,n=e.className,r=e.clone,l=e.component,d=Object(u.a)(e,["children","className","clone","component"]),h=c(e),f=Object(m.a)(h.root,n),g=d;if(o&&(g=Z(g,o)),r)return s.a.cloneElement(i,Object(p.a)({className:Object(m.a)(i.props.className,f)},g));if("function"==typeof i)return i(Object(p.a)({className:f},g));var y=l||t;return s.a.createElement(y,Object(p.a)({ref:a,className:f},g),i)}));return J()(d,t),d}}(t);return function(t,a){return e(t,Object(p.a)({defaultTheme:tt.a},a))}},at=C(S(R,T,A,F,M,B,z,U,K.b,Y)),it=et("div")(at,{name:"MuiBox"}),st=a(472),nt=a.n(st),ot=(a(471),a(450)),rt=a(461);function lt(t,e,a){if(!t)return[];return t.filter(t=>"Group"!==t.type).sort((t,e)=>(t.stt||0)-(e.stt||0)).map(i=>{let n;if(i.grid_configs)try{n=new Function("data",(i.grid_configs.includes("return ")?"":"return ")+i.grid_configs)({})}catch(t){console.error(t.message,i.grid_configs),n={}}else n={};if(("Array"===i.type||"Mixed"===i.type)&&!n.render)return null;let r=n.align||i.align;if(!r)switch(i.type){case"Number":r="right";break;case"Date":r="left";break;case"Action":r="center";break;default:r="left"}let p,u=i.ref_label_as||i.ref_label||i.name;p=i.ref_model&&"account"===i.ref_model||t.find(t=>t.name===u)?i.name:u;let m=i.html_component_display;return"Boolean"!==i.type||m||(m="checkbox"),"Link"!==i.type||m||(m="Link"),"Action"!==i.type||m||(m="Button"),"Image"===i.type&&(m="img"),"Array"!==i.type&&"Object"!==i.type||(m="html"),{id:p,name:i.name,type:i.type,is_title:i.is_title,hideLabelWhenSmallScreen:"h4"==i.html_component_display||"h3"==i.html_component_display||"h2"==i.html_component_display||"h1"==i.html_component_display,label:e.apis.getLabel(i.header),minWidth:n.minWidth||0,maxWidth:n.maxWidth||0,default:i.default,align:r,format:(t,r,p,u={})=>{let f,g;if(i.grid_configs)try{f=new Function("data",(i.grid_configs.includes("return ")?"":"return ")+i.grid_configs)(r)}catch(t){console.error(t.message,i.grid_configs),f={}}else f={};switch(u.color||(u.color=n.color||i.color||"#212121"),u.fontWeight||(u.fontWeight=r.bold?420:void 0),i.type){case"Number":nt()(t)&&(t=l()(t).format(n.format));break;case"Date":t&&(t=o()(t).format(n.format||i.format||"DD/MM/YYYY"));break;case"DateTime":t&&(t=o()(t).format(n.format||i.format||"DD/MM/YYYY HH:mm A"));break;case"Time":t&&(t=o()(t).format(n.format||i.format||"HH:mm A"))}if(n.render){let a=(n.render.indexOf("return ")<0?"return ":"")+n.render;try{g=new Function("row","data","master","value","style","server_url","context",a)(r,r,r,t,u,e.config.server_url,e)}catch(t){console.error(t,a),g=t.message}}if(!m){if(r[i.name]&&"File"===i.type||"OtherFile"===i.type||"Pdf"===i.type)return s.a.createElement(h.a,{disabled:f.disabled,size:"small",variant:n.variant||"outlined",color:n.color||"primary",onClick:()=>(async(t,e,a)=>{if(a||(a=e.split("/").pop()),e.indexOf("/file/download/")>0)try{let e=await t.apis.asyncGetData(t.userInfo.token,"file",{_id:a});e&&(a=e.file.name)}catch(t){console.error(t)}t.apis.downloadFile(e+"?access_token="+t.userInfo.token,a)})(e,`${e.config.server_url}${r[i.name]}`)},e.apis.getLabel("Tải về"));{let e,a={};return r.color&&"ten_trang_thai"===(i.ref_label_as||i.ref_label||i.name)&&(a.backgroundColor=r.color,a.color="white",a.padding=2,a.borderRadius=2,a.whiteSpace="nowrap",e="caption"),a={...u,...a},s.a.createElement(c.a,{variant:e,noWrap:"nowrap"==a.whiteSpace,style:a},g||t||"--")}}switch(m){case"html":return s.a.createElement("div",{dangerouslySetInnerHTML:{__html:g||t||""}});case"checkbox":return s.a.createElement(rt.a,{value:t,readOnly:!0});case"progress":return s.a.createElement(it,{display:"flex",alignItems:"center"},s.a.createElement(it,{width:"100%",mr:1},s.a.createElement(_,{variant:"determinate",value:t>100?100:t,color:t<50?"primary":"secondary"})),s.a.createElement(it,{minWidth:35},s.a.createElement(c.a,{variant:"body2",color:"textSecondary"},t+"%")));case"circularprogress":return s.a.createElement(it,{position:"relative",display:"inline-flex"},s.a.createElement(v.a,{variant:"static",value:t>100?100:t,style:{color:t<50?"red":"green"}}),s.a.createElement(it,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},s.a.createElement(c.a,{variant:"caption",component:"div",color:"textSecondary"},t+"%")));case"img":{if(n.height||(n.height=32),!t&&!g)return null;let a=t&&0===t.indexOf("http")?t:`${e.config.server_url}${g||t}?size=S`;return s.a.createElement(ot.LazyLoadImage,{effect:"blur",src:a,style:n})}case"Link":if(!i.default)return s.a.createElement(h.a,{size:"small",disabled:f.disabled,variant:n.variant||"outlined",color:n.color||"primary"},g?s.a.createElement("span",{dangerouslySetInnerHTML:{__html:g}}):e.apis.getLabel(i.header));try{let t=new Function("master","context",(i.default.indexOf("return ")<0?"return ":"")+i.default)(r,e);return s.a.createElement(h.a,{size:"small",disabled:f.disabled,variant:n.variant||"outlined",color:n.color||"primary",component:d.c,to:t},g?s.a.createElement("span",{dangerouslySetInnerHTML:{__html:g}}):e.apis.getLabel(i.header))}catch(t){return s.a.createElement("span",{style:{color:"red"}},t.message)}case"Button":{if(!i.default)return s.a.createElement(h.a,{size:"small",disabled:f.disabled,variant:n.variant||"outlined",color:n.color||"primary"},g?s.a.createElement("span",{dangerouslySetInnerHTML:{__html:g}}):e.apis.getLabel(i.header));let t=`return (async ()=>{\n                ${i.default||"alert('Chưa khai báo xử lý hành động này')"}\n              })()`,o=new Function("master","API","context","parent",t);return s.a.createElement(h.a,{disabled:f.disabled,size:"small",variant:n.variant||"outlined",color:n.color||"primary",onClick:()=>o(r,e.apis,e,a)},g?s.a.createElement("span",{dangerouslySetInnerHTML:{__html:g}}):e.apis.getLabel(i.header))}default:return s.a.createElement(c.a,{component:i.html_component_display,style:u,noWrap:"nowrap"==u.whiteSpace},""+(g||t||""))}}}}).filter(t=>t)}},648:function(t,e,a){"use strict";var i=a(1),s=a.n(i),n=a(1703),o=a(480),r=a(1714),l=a(1715),c=a(437),d=a(397),h=a.n(d),p=a(876),u=a(1711),m=a(670),f=a(55),g=a.n(f),y=a(12),b=a(368),x=(a(535),a(369)),_=a(378),v=a(395),w=a(370);n.a.styles;var E=i.forwardRef((function(t,e){var a=t.children,s=t.classes,n=t.className,o=t.color,r=void 0===o?"default":o,l=t.component,c=void 0===l?"div":l,d=t.disabled,h=void 0!==d&&d,p=t.disableElevation,u=void 0!==p&&p,m=t.disableFocusRipple,f=void 0!==m&&m,g=t.disableRipple,v=void 0!==g&&g,w=t.fullWidth,E=void 0!==w&&w,I=t.orientation,k=void 0===I?"horizontal":I,C=t.size,S=void 0===C?"medium":C,P=t.variant,O=void 0===P?"outlined":P,L=Object(b.a)(t,["children","classes","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"]),D=Object(x.a)(s.grouped,s["grouped".concat(Object(_.a)(k))],s["grouped".concat(Object(_.a)(O))],s["grouped".concat(Object(_.a)(O)).concat(Object(_.a)(k))],s["grouped".concat(Object(_.a)(O)).concat("default"!==r?Object(_.a)(r):"")],h&&s.disabled);return i.createElement(c,Object(y.a)({role:"group",className:Object(x.a)(s.root,n,E&&s.fullWidth,u&&s.disableElevation,"contained"===O&&s.contained,"vertical"===k&&s.vertical),ref:e},L),i.Children.map(a,(function(t){return i.isValidElement(t)?i.cloneElement(t,{className:Object(x.a)(D,t.props.className),color:t.props.color||r,disabled:t.props.disabled||h,disableElevation:t.props.disableElevation||u,disableFocusRipple:f,disableRipple:v,fullWidth:E,size:t.props.size||S,variant:t.props.variant||O}):null})))})),I=Object(w.a)((function(t){return{root:{display:"inline-flex",borderRadius:t.shape.borderRadius},contained:{boxShadow:t.shadows[2]},disableElevation:{boxShadow:"none"},disabled:{},fullWidth:{width:"100%"},vertical:{flexDirection:"column"},grouped:{minWidth:40},groupedHorizontal:{"&:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0}},groupedVertical:{"&:not(:first-child)":{borderTopRightRadius:0,borderTopLeftRadius:0},"&:not(:last-child)":{borderBottomRightRadius:0,borderBottomLeftRadius:0}},groupedText:{},groupedTextHorizontal:{"&:not(:last-child)":{borderRight:"1px solid ".concat("light"===t.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")}},groupedTextVertical:{"&:not(:last-child)":{borderBottom:"1px solid ".concat("light"===t.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")}},groupedTextPrimary:{"&:not(:last-child)":{borderColor:Object(v.a)(t.palette.primary.main,.5)}},groupedTextSecondary:{"&:not(:last-child)":{borderColor:Object(v.a)(t.palette.secondary.main,.5)}},groupedOutlined:{},groupedOutlinedHorizontal:{"&:not(:first-child)":{marginLeft:-1},"&:not(:last-child)":{borderRightColor:"transparent"}},groupedOutlinedVertical:{"&:not(:first-child)":{marginTop:-1},"&:not(:last-child)":{borderBottomColor:"transparent"}},groupedOutlinedPrimary:{"&:hover":{borderColor:t.palette.primary.main}},groupedOutlinedSecondary:{"&:hover":{borderColor:t.palette.secondary.main}},groupedContained:{boxShadow:"none"},groupedContainedHorizontal:{"&:not(:last-child)":{borderRight:"1px solid ".concat(t.palette.grey[400]),"&$disabled":{borderRight:"1px solid ".concat(t.palette.action.disabled)}}},groupedContainedVertical:{"&:not(:last-child)":{borderBottom:"1px solid ".concat(t.palette.grey[400]),"&$disabled":{borderBottom:"1px solid ".concat(t.palette.action.disabled)}}},groupedContainedPrimary:{"&:not(:last-child)":{borderColor:t.palette.primary.dark}},groupedContainedSecondary:{"&:not(:last-child)":{borderColor:t.palette.secondary.dark}}}}),{name:"MuiButtonGroup"})(E),k=a(580),C=a.n(k),S=a(875),P=a(1705),O=a(1707),L=a(736);function D(){return(D=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t}).apply(this,arguments)}class j extends s.a.PureComponent{constructor(t){super(t),this.anchorRef=s.a.createRef(),this.state={open:!1}}handleToggle(){this.setState({open:!this.state.open})}handleClose(t){this.anchorRef.current&&this.anchorRef.current.contains(t.target)||this.setState({open:!1})}render(){let{open:t}=this.state;return s.a.createElement(s.a.Fragment,null,s.a.createElement(I,{variant:"contained",color:"primary",ref:this.anchorRef,"aria-label":"split button"},s.a.createElement(n.a,{color:this.props.color,onClick:this.props.onClick},this.props.label),this.props.children&&s.a.createElement(n.a,{color:this.props.color,size:"small","aria-controls":t?"split-button-menu":void 0,"aria-expanded":t?"true":void 0,"aria-haspopup":"menu",onClick:this.handleToggle.bind(this)},s.a.createElement(C.a,null))),s.a.createElement(L.a,{open:t,anchorEl:this.anchorRef.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:99999999999}},({TransitionProps:t,placement:e})=>s.a.createElement(P.a,D({},t,{style:{transformOrigin:"bottom"===e?"center top":"center bottom"}}),s.a.createElement(O.a,null,s.a.createElement(S.a,{onClickAway:this.handleClose.bind(this)},this.props.children)))))}}j.propTypes={children:g.a.any,onClick:g.a.func,color:g.a.string,label:g.a.string.isRequired};var R=j,T=a(374),A=a(386),F=a.n(A),M=a(401);class B extends s.a.PureComponent{constructor(t){super(t),this.state={formOpen:!1,data:{},master:{},load:0,templateFormLoaded:!1}}async componentDidMount(){}componentDidUpdate(t){(t.form||!this.props.form)&&(t.listInfo||!this.props.listInfo)||this.setState({load:this.state.load+1})}createCustomForm(){if(this.props.form)return null;if(!this.props.listInfo||!this.props.listInfo.custom_fields)return null;let{data:t,master:e}=this.state;return t.exfields||(t.exfields={}),s.a.createElement(this.state.FormBase,{code:this.props.code,history:this.props.history,parent:this.props.parent,fields:this.props.listInfo.custom_fields,master:e,data:t.exfields,dataPickers:this.props.dataPickers,handleValueChanged:this.handleCustomValueChanged.bind(this)})}handleCustomValueChanged(t){let e=this.state.data.exfields;for(let a in t)e[a]=t[a];this.props.form&&this.setState({data:this.state.data,load:this.state.load+1})}handleValueChanged(t){let e=this.state.data;for(let a in t)e[a]=t[a];this.props.form&&this.setState({data:e,load:this.state.load+1})}async open(t,e,i={}){if(this.state.FormBase)this.setState({formOpen:!0,data:t,master:e,form_options:i});else{const{default:s}=await Promise.all([a.e(3),a.e(2),a.e(5),a.e(7),a.e(17)]).then(a.bind(null,526));this.setState({FormBase:s,formOpen:!0,data:t,master:e,form_options:i})}}close(){this.setState({formOpen:!1,load:this.state.load+1})}getData(){return this.state.data}async viewSocai(){this.state.data._id&&this.context.objectPicker("data_socai",this.context.apis.getLabel("Sổ cái"),{condition:{id_ct:this.state.data._id},props:{readOnly:!0,formSize:"md",hideHeader:!0,showPages:!0}})}async viewSokho(){this.state.data._id&&this.context.objectPicker("data_sokho",this.context.apis.getLabel("Sổ cái"),{condition:{id_ct:this.state.data._id},props:{readOnly:!0,formSize:"md",hideHeader:!0,showPages:!0}})}async viewData(){const{default:t}=await a.e(11).then(a.t.bind(null,1739,7));this.context.alert(s.a.createElement(t,{src:this.state.data}),null)}async viewLog(){if(this.state.data._id){this.context.setProgressStatus(!0);try{let t=(await this.context.apis.asyncGetLogById(this.context.userInfo.token,this.props.code,this.state.data._id)).map(t=>{let e=t.data_changed||(t.data?Object(M.difference)(t.data.newData,t.data.oldData):{});return delete e.is_full_data,delete e.collection_name,delete e.date_updated,delete e.user_updated,delete e.approve_data,e.ten_trang_thai&&delete e.color,delete e.ten_trang_thai,{User:t.user_created,Date:F()(t.date_created).format("DD/MM/YYYY HH:mm A"),Action:t.action,IP:t.ip.split(":").pop(),"User agent":t.user_agent,"Data changed":e}});const{default:e}=await a.e(11).then(a.t.bind(null,1739,7));this.context.alert(s.a.createElement(e,{src:t}),null)}catch(t){this.context.alert(t.message)}}}saveItem(){this.props.saveItem&&this.props.saveItem(this.getData())}copyItem(){this.setState({formOpen:!1,load:this.state.load+1},()=>{this.props.copyItem&&this.props.copyItem(this.getData())})}deleteItem(){this.props.deleteItem&&this.props.deleteItem(this.getData())}async createTemplate(){await new Promise(t=>{(async()=>{if(this.templateRef)t();else{const{default:e}=await Promise.resolve().then(a.bind(null,488));this.setState({TemplateForm:s.a.createElement(e,{noRender:!0,code:"templatevoucher",ref:t=>this.templateRef=t}),templateFormLoaded:!0,load:this.state.load+1},()=>{t()})}})()});let t=this.getData();this.templateRef.quickAdd({data:t,voucher_code:this.props.code.toUpperCase(),title:t.dien_giai})}render(){if(!this.state.formOpen||!this.state.FormBase)return null;const{data:t}=this.state,{formHeaderColor:e,mainTextColor:a}=this.context.config,i=(this.props.listInfo||{}).form_size||this.props.formSize||"md";return s.a.createElement(r.a,{fullScreen:this.props.fullScreen,fullWidth:this.props.fullWidth,maxWidth:i,open:this.state.formOpen,onClose:this.close.bind(this),disableBackdropClick:!0,disableEscapeKeyDown:!1},s.a.createElement(c.a,{style:{backgroundColor:e,color:a}},s.a.createElement(o.a,{container:!0,spacing:0,direction:"row",justify:"space-between"},s.a.createElement(o.a,{item:!0,xs:12,sm:12,md:6},(this.state.form_options||{}).title||this.props.title),s.a.createElement(o.a,{item:!0,xs:12,sm:12,md:6,style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end"}},s.a.createElement(R,{color:"secondary",label:this.context.apis.getLabel("Lưu"),onClick:this.saveItem.bind(this)},!!t._id&&s.a.createElement(u.a,null,this.props.copyItem&&s.a.createElement(p.a,{onClick:this.copyItem.bind(this)},this.context.apis.getLabel("Sao chép")),this.props.deleteItem&&s.a.createElement(p.a,{onClick:this.deleteItem.bind(this)},this.context.apis.getLabel("Xoá")),this.props.code&&s.a.createElement(p.a,{onClick:this.createTemplate.bind(this)},this.context.apis.getLabel("Tạo mẫu")),this.props.code&&s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,null),s.a.createElement(p.a,{onClick:this.viewLog.bind(this)},this.context.apis.getLabel("Lịch sử cập nhật"))),this.props.code&&s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,null),s.a.createElement(p.a,{onClick:this.viewSocai.bind(this)},this.context.apis.getLabel("Dữ liệu sổ cái"))),this.props.code&&s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,null),s.a.createElement(p.a,{onClick:this.viewSokho.bind(this)},this.context.apis.getLabel("Dữ liệu sổ kho"))),s.a.createElement(m.a,null),s.a.createElement(p.a,{onClick:this.viewData.bind(this)},this.context.apis.getLabel("Dữ liệu JSON")))),s.a.createElement(n.a,{style:{marginLeft:5},variant:"contained",onClick:this.close.bind(this)},s.a.createElement(h.a,null))))),s.a.createElement(l.a,{style:{padding:0}},s.a.createElement("form",{noValidatestyle:!0,style:{height:"100%"}},!this.props.form&&!!this.props.listInfo&&s.a.createElement(this.state.FormBase,{code:this.props.code,history:this.props.history,fields:this.props.listInfo.fields,master:this.state.master,data:this.state.data,dataPickers:this.props.dataPickers,parent:this.props.parent,handleValueChanged:this.handleValueChanged.bind(this)}),!!this.props.form&&this.props.form(this.state.data,this.handleValueChanged.bind(this)),this.createCustomForm()),this.state.TemplateForm))}}B.contextType=T.a,B.propTypes={title:g.a.string,code:g.a.string,listInfo:g.a.object,form:g.a.any,saveItem:g.a.func,copyItem:g.a.func,deleteItem:g.a.func,dataPickers:g.a.object,fullScreen:g.a.bool,fullWidth:g.a.bool,formSize:g.a.oneOf(["sm","md","lg"]),history:g.a.any,parent:g.a.any};e.a=B},818:function(t,e,a){"use strict";var i=a(12),s=a(368),n=a(1),o=(a(55),a(369)),r=a(370),l=a(1757),c=a(876),d=a(1750),h=a(743),p=a(874),u=a(1709),m=a(486),f=a(487),g=a(415),y=a(669),b=n.createElement(f.a,null),x=n.createElement(m.a,null),_=n.createElement(m.a,null),v=n.createElement(f.a,null),w=n.forwardRef((function(t,e){var a=t.backIconButtonProps,o=t.count,r=t.nextIconButtonProps,l=t.onChangePage,c=void 0===l?function(){}:l,d=t.onPageChange,h=void 0===d?function(){}:d,p=t.page,u=t.rowsPerPage,m=Object(s.a)(t,["backIconButtonProps","count","nextIconButtonProps","onChangePage","onPageChange","page","rowsPerPage"]),f=Object(g.a)();return n.createElement("div",Object(i.a)({ref:e},m),n.createElement(y.a,Object(i.a)({onClick:function(t){c(t,p-1),h(t,p-1)},disabled:0===p,color:"inherit"},a),"rtl"===f.direction?b:x),n.createElement(y.a,Object(i.a)({onClick:function(t){c(t,p+1),h(t,p+1)},disabled:-1!==o&&p>=Math.ceil(o/u)-1,color:"inherit"},r),"rtl"===f.direction?_:v))})),E=a(389),I=function(t){var e=t.from,a=t.to,i=t.count;return"".concat(e,"-").concat(a," of ").concat(-1!==i?i:"more than ".concat(a))},k=[10,25,50,100],C=n.forwardRef((function(t,e){var a,r=t.ActionsComponent,m=void 0===r?w:r,f=t.backIconButtonProps,g=t.backIconButtonText,y=void 0===g?"Previous page":g,b=t.classes,x=t.className,_=t.colSpan,v=t.component,C=void 0===v?h.a:v,S=t.count,P=t.labelDisplayedRows,O=void 0===P?I:P,L=t.labelRowsPerPage,D=void 0===L?"Rows per page:":L,j=t.nextIconButtonProps,R=t.nextIconButtonText,T=void 0===R?"Next page":R,A=t.onChangePage,F=t.onPageChange,M=t.onChangeRowsPerPage,B=t.onRowsPerPageChange,z=t.page,H=t.rowsPerPage,N=t.rowsPerPageOptions,q=void 0===N?k:N,V=t.SelectProps,G=void 0===V?{}:V,W=Object(s.a)(t,["ActionsComponent","backIconButtonProps","backIconButtonText","classes","className","colSpan","component","count","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","nextIconButtonText","onChangePage","onPageChange","onChangeRowsPerPage","onRowsPerPageChange","page","rowsPerPage","rowsPerPageOptions","SelectProps"]),$=M||B;C!==h.a&&"td"!==C||(a=_||1e3);var U=Object(E.a)(),K=Object(E.a)(),Y=G.native?"option":c.a;return n.createElement(C,Object(i.a)({className:Object(o.a)(b.root,x),colSpan:a,ref:e},W),n.createElement(p.a,{className:b.toolbar},n.createElement("div",{className:b.spacer}),q.length>1&&n.createElement(u.a,{color:"inherit",variant:"body2",className:b.caption,id:K},D),q.length>1&&n.createElement(d.a,Object(i.a)({classes:{select:b.select,icon:b.selectIcon},input:n.createElement(l.a,{className:Object(o.a)(b.input,b.selectRoot)}),value:H,onChange:$,id:U,labelId:K},G),q.map((function(t){return n.createElement(Y,{className:b.menuItem,key:t.value?t.value:t,value:t.value?t.value:t},t.label?t.label:t)}))),n.createElement(u.a,{color:"inherit",variant:"body2",className:b.caption},O({from:0===S?0:z*H+1,to:-1!==S?Math.min(S,(z+1)*H):(z+1)*H,count:-1===S?-1:S,page:z})),n.createElement(m,{className:b.actions,backIconButtonProps:Object(i.a)({title:y,"aria-label":y},f),count:S,nextIconButtonProps:Object(i.a)({title:T,"aria-label":T},j),onChangePage:A,onPageChange:F,page:z,rowsPerPage:H})))}));e.a=Object(r.a)((function(t){return{root:{color:t.palette.text.primary,fontSize:t.typography.pxToRem(14),overflow:"auto","&:last-child":{padding:0}},toolbar:{minHeight:52,paddingRight:2},spacer:{flex:"1 1 100%"},caption:{flexShrink:0},selectRoot:{marginRight:32,marginLeft:8},select:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"},selectIcon:{},input:{color:"inherit",fontSize:"inherit",flexShrink:0},menuItem:{},actions:{flexShrink:0,marginLeft:20}}}),{name:"MuiTablePagination"})(C)}},0,[0,4,1,2,18,3,5,7,17]]);